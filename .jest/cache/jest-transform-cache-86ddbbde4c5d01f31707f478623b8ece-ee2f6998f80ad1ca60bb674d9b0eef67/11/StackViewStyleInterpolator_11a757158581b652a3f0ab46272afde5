d816236ea1966265cf34f685500011b2
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactNative = require("react-native");

var _getSceneIndicesForInterpolationInputRange = _interopRequireDefault(require("../../utils/getSceneIndicesForInterpolationInputRange"));

var EPS = 1e-5;

function forInitial(props) {
  var navigation = props.navigation,
      scene = props.scene;
  var focused = navigation.state.index === scene.index;
  var opacity = focused ? 1 : 0;
  var translate = focused ? 0 : 1000000;
  return {
    opacity: opacity,
    transform: [{
      translateX: translate
    }, {
      translateY: translate
    }]
  };
}

function forHorizontal(props) {
  var layout = props.layout,
      position = props.position,
      scene = props.scene;

  if (!layout.isMeasured) {
    return forInitial(props);
  }

  var interpolate = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!interpolate) return {
    opacity: 0
  };
  var first = interpolate.first,
      last = interpolate.last;
  var index = scene.index;
  var width = layout.initWidth;
  var translateX = position.interpolate({
    inputRange: [first, index, last],
    outputRange: _reactNative.I18nManager.isRTL ? [-width, 0, width * 0.3] : [width, 0, width * -0.3],
    extrapolate: 'clamp'
  });
  var shadowOpacity = props.shadowEnabled ? position.interpolate({
    inputRange: [first, index, last],
    outputRange: [0, 0.7, 0],
    extrapolate: 'clamp'
  }) : null;
  var overlayOpacity = props.cardOverlayEnabled ? position.interpolate({
    inputRange: [index, last - 0.5, last, last + EPS],
    outputRange: [0, 0.07, 0.07, 0],
    extrapolate: 'clamp'
  }) : null;
  return {
    transform: [{
      translateX: translateX
    }],
    overlayOpacity: overlayOpacity,
    shadowOpacity: shadowOpacity
  };
}

function forVertical(props) {
  var layout = props.layout,
      position = props.position,
      scene = props.scene;

  if (!layout.isMeasured) {
    return forInitial(props);
  }

  var interpolate = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!interpolate) return {
    opacity: 0
  };
  var first = interpolate.first,
      last = interpolate.last;
  var index = scene.index;
  var height = layout.initHeight;
  var translateY = position.interpolate({
    inputRange: [first, index, last],
    outputRange: [height, 0, 0],
    extrapolate: 'clamp'
  });
  return {
    transform: [{
      translateY: translateY
    }]
  };
}

function forFadeFromBottomAndroid(props) {
  var layout = props.layout,
      position = props.position,
      scene = props.scene;

  if (!layout.isMeasured) {
    return forInitial(props);
  }

  var interpolate = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!interpolate) return {
    opacity: 0
  };
  var first = interpolate.first,
      last = interpolate.last;
  var index = scene.index;
  var opacity = position.interpolate({
    inputRange: [first, first + 0.5, first + 0.9, index, last - 1e-5, last],
    outputRange: [0, 0.25, 0.7, 1, 1, 0],
    extrapolate: 'clamp'
  });
  var height = layout.initHeight;
  var maxTranslation = height * 0.08;
  var translateY = position.interpolate({
    inputRange: [first, index, last],
    outputRange: [maxTranslation, 0, 0],
    extrapolate: 'clamp'
  });
  return {
    opacity: opacity,
    transform: [{
      translateY: translateY
    }]
  };
}

function forFadeToBottomAndroid(props) {
  var layout = props.layout,
      position = props.position,
      scene = props.scene;

  if (!layout.isMeasured) {
    return forInitial(props);
  }

  var interpolate = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!interpolate) return {
    opacity: 0
  };
  var first = interpolate.first,
      last = interpolate.last;
  var index = scene.index;
  var inputRange = [first, index, last];
  var opacity = position.interpolate({
    inputRange: inputRange,
    outputRange: [0, 1, 1],
    extrapolate: 'clamp'
  });
  var height = layout.initHeight;
  var maxTranslation = height * 0.08;
  var translateY = position.interpolate({
    inputRange: inputRange,
    outputRange: [maxTranslation, 0, 0],
    extrapolate: 'clamp'
  });
  return {
    opacity: opacity,
    transform: [{
      translateY: translateY
    }]
  };
}

function forFade(props) {
  var layout = props.layout,
      position = props.position,
      scene = props.scene;

  if (!layout.isMeasured) {
    return forInitial(props);
  }

  var interpolate = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!interpolate) return {
    opacity: 0
  };
  var first = interpolate.first,
      last = interpolate.last;
  var index = scene.index;
  var opacity = position.interpolate({
    inputRange: [first, index, last],
    outputRange: [0, 1, 1],
    extrapolate: 'clamp'
  });
  return {
    opacity: opacity
  };
}

function forNoAnimation() {
  return {};
}

var _default = {
  forHorizontal: forHorizontal,
  forVertical: forVertical,
  forFadeFromBottomAndroid: forFadeFromBottomAndroid,
  forFadeToBottomAndroid: forFadeToBottomAndroid,
  forFade: forFade,
  forNoAnimation: forNoAnimation
};
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlN0YWNrVmlld1N0eWxlSW50ZXJwb2xhdG9yLnRzeCJdLCJuYW1lcyI6WyJFUFMiLCJuYXZpZ2F0aW9uIiwic2NlbmUiLCJwcm9wcyIsImZvY3VzZWQiLCJvcGFjaXR5IiwidHJhbnNsYXRlIiwidHJhbnNmb3JtIiwidHJhbnNsYXRlWCIsInRyYW5zbGF0ZVkiLCJsYXlvdXQiLCJwb3NpdGlvbiIsImZvckluaXRpYWwiLCJpbnRlcnBvbGF0ZSIsImZpcnN0IiwibGFzdCIsImluZGV4Iiwid2lkdGgiLCJpbnB1dFJhbmdlIiwib3V0cHV0UmFuZ2UiLCJJMThuTWFuYWdlciIsImV4dHJhcG9sYXRlIiwic2hhZG93T3BhY2l0eSIsIm92ZXJsYXlPcGFjaXR5IiwiaGVpZ2h0IiwibWF4VHJhbnNsYXRpb24iLCJmb3JIb3Jpem9udGFsIiwiZm9yVmVydGljYWwiLCJmb3JGYWRlRnJvbUJvdHRvbUFuZHJvaWQiLCJmb3JGYWRlVG9Cb3R0b21BbmRyb2lkIiwiZm9yRmFkZSIsImZvck5vQW5pbWF0aW9uIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUEsSUFBQSxZQUFBLEdBQUEsT0FBQSxDQUFBLGNBQUEsQ0FBQTs7QUFDQSxJQUFBLDBDQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsdURBQUEsQ0FBQSxDQUFBOztBQUdBLElBQU1BLEdBQUcsR0FBVCxJQUFBOztBQW9CQSxTQUFBLFVBQUEsQ0FBQSxLQUFBLEVBQW1EO0FBQUEsTUFDekNDLFVBRHlDLEdBQ25CRSxLQURtQixDQUFBLFVBQUE7QUFBQSxNQUM3QkQsS0FENkIsR0FDbkJDLEtBRG1CLENBQUEsS0FBQTtBQUdqRCxNQUFNQyxPQUFPLEdBQUdILFVBQVUsQ0FBVkEsS0FBQUEsQ0FBQUEsS0FBQUEsS0FBMkJDLEtBQUssQ0FBaEQsS0FBQTtBQUNBLE1BQU1HLE9BQU8sR0FBR0QsT0FBTyxHQUFBLENBQUEsR0FBdkIsQ0FBQTtBQUVBLE1BQU1FLFNBQVMsR0FBR0YsT0FBTyxHQUFBLENBQUEsR0FBekIs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QUZzQjtBQUduQ0UsSUFBQUEsV0FBVyxFQUhiO0FBQXFDLEdBQXJCVixDQUFoQjtBQU1BLFNBQU87QUFDTE4sSUFBQUEsT0FBTyxFQURUO0FBQU8sR0FBUDtBQUtGOztBQUFBLFNBQUEsY0FBQSxHQUEwQjtBQUN4QixTQUFBLEVBQUE7OztlQUdhO0FBQ2JxQixFQUFBQSxhQUFhLEVBREEsYUFBQTtBQUViQyxFQUFBQSxXQUFXLEVBRkUsV0FBQTtBQUdiQyxFQUFBQSx3QkFBd0IsRUFIWCx3QkFBQTtBQUliQyxFQUFBQSxzQkFBc0IsRUFKVCxzQkFBQTtBQUtiQyxFQUFBQSxPQUFPLEVBTE0sT0FBQTtBQU1iQyxFQUFBQSxjQUFjLEVBTkQ7QUFBQSxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSTE4bk1hbmFnZXIgfSBmcm9tICdyZWFjdC1uYXRpdmUnO1xuaW1wb3J0IGdldFNjZW5lSW5kaWNlc0ZvckludGVycG9sYXRpb25JbnB1dFJhbmdlIGZyb20gJy4uLy4uL3V0aWxzL2dldFNjZW5lSW5kaWNlc0ZvckludGVycG9sYXRpb25JbnB1dFJhbmdlJztcbmltcG9ydCB7IFNjZW5lSW50ZXJwb2xhdG9yUHJvcHMgfSBmcm9tICcuLi8uLi90eXBlcyc7XG5cbmNvbnN0IEVQUyA9IDFlLTU7XG5cbi8qKlxuICogVXRpbGl0eSB0aGF0IGJ1aWxkcyB0aGUgc3R5bGUgZm9yIHRoZSBjYXJkIGluIHRoZSBjYXJkcyBzdGFjay5cbiAqXG4gKiAgICAgKy0tLS0tLS0tLS0tLStcbiAqICAgKy0rICAgICAgICAgICAgfFxuICogKy0rIHwgICAgICAgICAgICB8XG4gKiB8IHwgfCAgICAgICAgICAgIHxcbiAqIHwgfCB8ICBGb2N1c2VkICAgfFxuICogfCB8IHwgICBDYXJkICAgICB8XG4gKiB8IHwgfCAgICAgICAgICAgIHxcbiAqICstKyB8ICAgICAgICAgICAgfFxuICogICArLSsgICAgICAgICAgICB8XG4gKiAgICAgKy0tLS0tLS0tLS0tLStcbiAqL1xuXG4vKipcbiAqIFJlbmRlciB0aGUgaW5pdGlhbCBzdHlsZSB3aGVuIHRoZSBpbml0aWFsIGxheW91dCBpc24ndCBtZWFzdXJlZCB5ZXQuXG4gKi9cbmZ1bmN0aW9uIGZvckluaXRpYWwocHJvcHM6IFNjZW5lSW50ZXJwb2xhdG9yUHJvcHMpIHtcbiAgY29uc3QgeyBuYXZpZ2F0aW9uLCBzY2VuZSB9ID0gcHJvcHM7XG5cbiAgY29uc3QgZm9jdXNlZCA9IG5hdmlnYXRpb24uc3RhdGUuaW5kZXggPT09IHNjZW5lLmluZGV4O1xuICBjb25zdCBvcGFjaXR5ID0gZm9jdXNlZCA/IDEgOiAwO1xuICAvLyBJZiBub3QgZm9jdXNlZCwgbW92ZSB0aGUgc2NlbmUgZmFyIGF3YXkuXG4gIGNvbnN0IHRyYW5zbGF0ZSA9IGZvY3VzZWQgPyAwIDogMTAwMDAwMDtcbiAgcmV0dXJuIHtcbiAgICBvcGFjaXR5LFxuICAgIHRyYW5zZm9ybTogW3sgdHJhbnNsYXRlWDogdHJhbnNsYXRlIH0sIHsgdHJhbnNsYXRlWTogdHJhbnNsYXRlIH1dLFxuICB9O1xufVxuXG4vKipcbiAqIFN0YW5kYXJkIGlPUy1zdHlsZSBzbGlkZSBpbiBmcm9tIHRoZSByaWdodC5cbiAqL1xuZnVuY3Rpb24gZm9ySG9yaXpvbnRhbChwcm9wczogU2NlbmVJbnRlcnBvbGF0b3JQcm9wcykge1xuICBjb25zdCB7IGxheW91dCwgcG9zaXRpb24sIHNjZW5lIH0gPSBwcm9wcztcblxuICBpZiAoIWxheW91dC5pc01lYXN1cmVkKSB7XG4gICAgcmV0dXJuIGZvckluaXRpYWwocHJvcHMpO1xuICB9XG4gIGNvbnN0IGludGVycG9sYXRlID0gZ2V0U2NlbmVJbmRpY2VzRm9ySW50ZXJwb2xhdGlvbklucHV0UmFuZ2UocHJvcHMpO1xuXG4gIGlmICghaW50ZXJwb2xhdGUpIHJldHVybiB7IG9wYWNpdHk6IDAgfTtcblxuICBjb25zdCB7IGZpcnN0LCBsYXN0IH0gPSBpbnRlcnBvbGF0ZTtcbiAgY29uc3QgaW5kZXggPSBzY2VuZS5pbmRleDtcblxuICBjb25zdCB3aWR0aCA9IGxheW91dC5pbml0V2lkdGg7XG4gIGNvbnN0IHRyYW5zbGF0ZVggPSBwb3NpdGlvbi5pbnRlcnBvbGF0ZSh7XG4gICAgaW5wdXRSYW5nZTogW2ZpcnN0LCBpbmRleCwgbGFzdF0sXG4gICAgb3V0cHV0UmFuZ2U6IEkxOG5NYW5hZ2VyLmlzUlRMXG4gICAgICA/IFstd2lkdGgsIDAsIHdpZHRoICogMC4zXVxuICAgICAgOiBbd2lkdGgsIDAsIHdpZHRoICogLTAuM10sXG4gICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gIH0pO1xuXG4gIGNvbnN0IHNoYWRvd09wYWNpdHkgPSBwcm9wcy5zaGFkb3dFbmFibGVkXG4gICAgPyBwb3NpdGlvbi5pbnRlcnBvbGF0ZSh7XG4gICAgICAgIGlucHV0UmFuZ2U6IFtmaXJzdCwgaW5kZXgsIGxhc3RdLFxuICAgICAgICBvdXRwdXRSYW5nZTogWzAsIDAuNywgMF0sXG4gICAgICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICAgICAgfSlcbiAgICA6IG51bGw7XG5cbiAgbGV0IG92ZXJsYXlPcGFjaXR5ID0gcHJvcHMuY2FyZE92ZXJsYXlFbmFibGVkXG4gICAgPyBwb3NpdGlvbi5pbnRlcnBvbGF0ZSh7XG4gICAgICAgIGlucHV0UmFuZ2U6IFtpbmRleCwgbGFzdCAtIDAuNSwgbGFzdCwgbGFzdCArIEVQU10sXG4gICAgICAgIG91dHB1dFJhbmdlOiBbMCwgMC4wNywgMC4wNywgMF0sXG4gICAgICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICAgICAgfSlcbiAgICA6IG51bGw7XG5cbiAgcmV0dXJuIHtcbiAgICB0cmFuc2Zvcm06IFt7IHRyYW5zbGF0ZVggfV0sXG4gICAgb3ZlcmxheU9wYWNpdHksXG4gICAgc2hhZG93T3BhY2l0eSxcbiAgfTtcbn1cblxuLyoqXG4gKiBTdGFuZGFyZCBpT1Mtc3R5bGUgc2xpZGUgaW4gZnJvbSB0aGUgYm90dG9tICh1c2VkIGZvciBtb2RhbHMpLlxuICovXG5mdW5jdGlvbiBmb3JWZXJ0aWNhbChwcm9wczogU2NlbmVJbnRlcnBvbGF0b3JQcm9wcykge1xuICBjb25zdCB7IGxheW91dCwgcG9zaXRpb24sIHNjZW5lIH0gPSBwcm9wcztcblxuICBpZiAoIWxheW91dC5pc01lYXN1cmVkKSB7XG4gICAgcmV0dXJuIGZvckluaXRpYWwocHJvcHMpO1xuICB9XG4gIGNvbnN0IGludGVycG9sYXRlID0gZ2V0U2NlbmVJbmRpY2VzRm9ySW50ZXJwb2xhdGlvbklucHV0UmFuZ2UocHJvcHMpO1xuXG4gIGlmICghaW50ZXJwb2xhdGUpIHJldHVybiB7IG9wYWNpdHk6IDAgfTtcblxuICBjb25zdCB7IGZpcnN0LCBsYXN0IH0gPSBpbnRlcnBvbGF0ZTtcbiAgY29uc3QgaW5kZXggPSBzY2VuZS5pbmRleDtcbiAgY29uc3QgaGVpZ2h0ID0gbGF5b3V0LmluaXRIZWlnaHQ7XG4gIGNvbnN0IHRyYW5zbGF0ZVkgPSBwb3NpdGlvbi5pbnRlcnBvbGF0ZSh7XG4gICAgaW5wdXRSYW5nZTogW2ZpcnN0LCBpbmRleCwgbGFzdF0sXG4gICAgb3V0cHV0UmFuZ2U6IFtoZWlnaHQsIDAsIDBdLFxuICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICB9KTtcblxuICByZXR1cm4ge1xuICAgIHRyYW5zZm9ybTogW3sgdHJhbnNsYXRlWSB9XSxcbiAgfTtcbn1cblxuLyoqXG4gKiBTdGFuZGFyZCBBbmRyb2lkLXN0eWxlIGZhZGUgaW4gZnJvbSB0aGUgYm90dG9tLlxuICovXG5mdW5jdGlvbiBmb3JGYWRlRnJvbUJvdHRvbUFuZHJvaWQocHJvcHM6IFNjZW5lSW50ZXJwb2xhdG9yUHJvcHMpIHtcbiAgY29uc3QgeyBsYXlvdXQsIHBvc2l0aW9uLCBzY2VuZSB9ID0gcHJvcHM7XG5cbiAgaWYgKCFsYXlvdXQuaXNNZWFzdXJlZCkge1xuICAgIHJldHVybiBmb3JJbml0aWFsKHByb3BzKTtcbiAgfVxuICBjb25zdCBpbnRlcnBvbGF0ZSA9IGdldFNjZW5lSW5kaWNlc0ZvckludGVycG9sYXRpb25JbnB1dFJhbmdlKHByb3BzKTtcblxuICBpZiAoIWludGVycG9sYXRlKSByZXR1cm4geyBvcGFjaXR5OiAwIH07XG5cbiAgY29uc3QgeyBmaXJzdCwgbGFzdCB9ID0gaW50ZXJwb2xhdGU7XG4gIGNvbnN0IGluZGV4ID0gc2NlbmUuaW5kZXg7XG4gIGNvbnN0IG9wYWNpdHkgPSBwb3NpdGlvbi5pbnRlcnBvbGF0ZSh7XG4gICAgaW5wdXRSYW5nZTogW2ZpcnN0LCBmaXJzdCArIDAuNSwgZmlyc3QgKyAwLjksIGluZGV4LCBsYXN0IC0gMWUtNSwgbGFzdF0sXG4gICAgb3V0cHV0UmFuZ2U6IFswLCAwLjI1LCAwLjcsIDEsIDEsIDBdLFxuICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICB9KTtcblxuICBjb25zdCBoZWlnaHQgPSBsYXlvdXQuaW5pdEhlaWdodDtcbiAgY29uc3QgbWF4VHJhbnNsYXRpb24gPSBoZWlnaHQgKiAwLjA4O1xuICBjb25zdCB0cmFuc2xhdGVZID0gcG9zaXRpb24uaW50ZXJwb2xhdGUoe1xuICAgIGlucHV0UmFuZ2U6IFtmaXJzdCwgaW5kZXgsIGxhc3RdLFxuICAgIG91dHB1dFJhbmdlOiBbbWF4VHJhbnNsYXRpb24sIDAsIDBdLFxuICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICB9KTtcblxuICByZXR1cm4ge1xuICAgIG9wYWNpdHksXG4gICAgdHJhbnNmb3JtOiBbeyB0cmFuc2xhdGVZIH1dLFxuICB9O1xufVxuXG5mdW5jdGlvbiBmb3JGYWRlVG9Cb3R0b21BbmRyb2lkKHByb3BzOiBTY2VuZUludGVycG9sYXRvclByb3BzKSB7XG4gIGNvbnN0IHsgbGF5b3V0LCBwb3NpdGlvbiwgc2NlbmUgfSA9IHByb3BzO1xuXG4gIGlmICghbGF5b3V0LmlzTWVhc3VyZWQpIHtcbiAgICByZXR1cm4gZm9ySW5pdGlhbChwcm9wcyk7XG4gIH1cbiAgY29uc3QgaW50ZXJwb2xhdGUgPSBnZXRTY2VuZUluZGljZXNGb3JJbnRlcnBvbGF0aW9uSW5wdXRSYW5nZShwcm9wcyk7XG5cbiAgaWYgKCFpbnRlcnBvbGF0ZSkgcmV0dXJuIHsgb3BhY2l0eTogMCB9O1xuXG4gIGNvbnN0IHsgZmlyc3QsIGxhc3QgfSA9IGludGVycG9sYXRlO1xuICBjb25zdCBpbmRleCA9IHNjZW5lLmluZGV4O1xuICBjb25zdCBpbnB1dFJhbmdlID0gW2ZpcnN0LCBpbmRleCwgbGFzdF07XG5cbiAgY29uc3Qgb3BhY2l0eSA9IHBvc2l0aW9uLmludGVycG9sYXRlKHtcbiAgICBpbnB1dFJhbmdlLFxuICAgIG91dHB1dFJhbmdlOiBbMCwgMSwgMV0sXG4gICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gIH0pO1xuXG4gIGNvbnN0IGhlaWdodCA9IGxheW91dC5pbml0SGVpZ2h0O1xuICBjb25zdCBtYXhUcmFuc2xhdGlvbiA9IGhlaWdodCAqIDAuMDg7XG5cbiAgY29uc3QgdHJhbnNsYXRlWSA9IHBvc2l0aW9uLmludGVycG9sYXRlKHtcbiAgICBpbnB1dFJhbmdlLFxuICAgIG91dHB1dFJhbmdlOiBbbWF4VHJhbnNsYXRpb24sIDAsIDBdLFxuICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICB9KTtcblxuICByZXR1cm4ge1xuICAgIG9wYWNpdHksXG4gICAgdHJhbnNmb3JtOiBbeyB0cmFuc2xhdGVZIH1dLFxuICB9O1xufVxuXG4vKipcbiAqICBmYWRlSW4gYW5kIGZhZGVPdXRcbiAqL1xuZnVuY3Rpb24gZm9yRmFkZShwcm9wczogU2NlbmVJbnRlcnBvbGF0b3JQcm9wcykge1xuICBjb25zdCB7IGxheW91dCwgcG9zaXRpb24sIHNjZW5lIH0gPSBwcm9wcztcblxuICBpZiAoIWxheW91dC5pc01lYXN1cmVkKSB7XG4gICAgcmV0dXJuIGZvckluaXRpYWwocHJvcHMpO1xuICB9XG4gIGNvbnN0IGludGVycG9sYXRlID0gZ2V0U2NlbmVJbmRpY2VzRm9ySW50ZXJwb2xhdGlvbklucHV0UmFuZ2UocHJvcHMpO1xuXG4gIGlmICghaW50ZXJwb2xhdGUpIHJldHVybiB7IG9wYWNpdHk6IDAgfTtcblxuICBjb25zdCB7IGZpcnN0LCBsYXN0IH0gPSBpbnRlcnBvbGF0ZTtcbiAgY29uc3QgaW5kZXggPSBzY2VuZS5pbmRleDtcbiAgY29uc3Qgb3BhY2l0eSA9IHBvc2l0aW9uLmludGVycG9sYXRlKHtcbiAgICBpbnB1dFJhbmdlOiBbZmlyc3QsIGluZGV4LCBsYXN0XSxcbiAgICBvdXRwdXRSYW5nZTogWzAsIDEsIDFdLFxuICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICB9KTtcblxuICByZXR1cm4ge1xuICAgIG9wYWNpdHksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGZvck5vQW5pbWF0aW9uKCkge1xuICByZXR1cm4ge307XG59XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgZm9ySG9yaXpvbnRhbCxcbiAgZm9yVmVydGljYWwsXG4gIGZvckZhZGVGcm9tQm90dG9tQW5kcm9pZCxcbiAgZm9yRmFkZVRvQm90dG9tQW5kcm9pZCxcbiAgZm9yRmFkZSxcbiAgZm9yTm9BbmltYXRpb24sXG59O1xuIl19