460059c085877b0df56db5f7ad36baa2
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread"));

var Animated = require('Animated');

var Easing = require('Easing');

var NativeMethodsMixin = require('NativeMethodsMixin');

var Platform = require('Platform');

var React = require('React');

var PropTypes = require('prop-types');

var Touchable = require('Touchable');

var TouchableWithoutFeedback = require('TouchableWithoutFeedback');

var createReactClass = require('create-react-class');

var ensurePositiveDelayProps = require('ensurePositiveDelayProps');

var flattenStyle = require('flattenStyle');

var PRESS_RETENTION_OFFSET = {
  top: 20,
  left: 20,
  right: 20,
  bottom: 30
};
var TouchableOpacity = createReactClass({
  displayName: 'TouchableOpacity',
  mixins: [Touchable.Mixin.withoutDefaultFocusAndBlur, NativeMethodsMixin],
  propTypes: (0, _objectSpread2.default)({}, TouchableWithoutFeedback.propTypes, {
    activeOpacity: PropTypes.number,
    hasTVPreferredFocus: PropTypes.bool,
    tvParallaxProperties: PropTypes.object
  }),
  getDefaultProps: function getDefaultProps() {
    return {
      activeOpacity: 0.2
    };
  },
  getInitialState: function getInitialState() {
    return (0, _objectSpread2.default)({}, this.touchableGetInitialState(), {
      anim: new Animated.Value(this._getChildStyleOpacityWithDefault())
    });
  },
  componentDidMount: function componentDidMount() {
    ensurePositiveDelayProps(this.props);
  },
  UNSAFE_componentWillReceiveProps: function UNSAFE_componentWillReceiveProps(nextProps) {
    ensurePositiveDelayProps(nextProps);
  },
  componentDidUpdate: function componentDidUpdate(prevProps, prevState) {
    if (this.props.disabled !== prevProps.disabled) {
      this._opacityInactive(250);
    }
  },
  setOpacityTo: function setOpacityTo(value, duration) {
    Animated.timing(this.state.anim, {
      toValue: value,
      duration: duration,
      easing: Easing.inOut(Easing.quad),
      useNativeDriver: true
    }).start();
  },
  touchableHandleActivePressIn: function touchableHandleActivePressIn(e) {
    if (e.dispatchConfig.registrationName === 'onResponderGrant') {
      this._opacityActive(0);
    } else {
      this._opacityActive(150);
    }

    this.props.onPressIn && this.props.onPressIn(e);
  },
  touchableHandleActivePressOut: function touchableHandleActivePressOut(e) {
    this._opacityInactive(250);

    this.props.onPressOut && this.props.onPressOut(e);
  },
  touchableHandleFocus: function touchableHandleFocus(e) {
    if (Platform.isTV) {
      this._opacityActive(150);
    }

    this.props.onFocus && this.props.onFocus(e);
  },
  touchableHandleBlur: function touchableHandleBlur(e) {
    if (Platform.isTV) {
      this._opacityInactive(250);
    }

    this.props.onBlur && this.props.onBlur(e);
  },
  touchableHandlePress: function touchableHandlePress(e) {
    this.props.onPress && this.props.onPress(e);
  },
  touchableHandleLongPress: function touchableHandleLongPress(e) {
    this.props.onLongPress && this.props.onLongPress(e);
  },
  touchableGetPressRectOffset: function touchableGetPressRectOffset() {
    return this.props.pressRetentionOffset || PRESS_RETENTION_OFFSET;
  },
  touchableGetHitSlop: function touchableGetHitSlop() {
    return this.props.hitSlop;
  },
  touchableGetHighlightDelayMS: function touchableGetHighlightDelayMS() {
    return this.props.delayPressIn || 0;
  },
  touchableGetLongPressDelayMS: function touchableGetLongPressDelayMS() {
    return this.props.delayLongPress === 0 ? 0 : this.props.delayLongPress || 500;
  },
  touchableGetPressOutDelayMS: function touchableGetPressOutDelayMS() {
    return this.props.delayPressOut;
  },
  _opacityActive: function _opacityActive(duration) {
    this.setOpacityTo(this.props.activeOpacity, duration);
  },
  _opacityInactive: function _opacityInactive(duration) {
    this.setOpacityTo(this._getChildStyleOpacityWithDefault(), duration);
  },
  _getChildStyleOpacityWithDefault: function _getChildStyleOpacityWithDefault() {
    var childStyle = flattenStyle(this.props.style) || {};
    return childStyle.opacity == null ? 1 : childStyle.opacity;
  },
  render: function render() {
    return React.createElement(Animated.View, {
      accessible: this.props.accessible !== false,
      accessibilityLabel: this.props.accessibilityLabel,
      accessibilityHint: this.props.accessibilityHint,
      accessibilityRole: this.props.accessibilityRole,
      accessibilityStates: this.props.accessibilityStates,
      style: [this.props.style, {
        opacity: this.state.anim
      }],
      nativeID: this.props.nativeID,
      testID: this.props.testID,
      onLayout: this.props.onLayout,
      isTVSelectable: true,
      hasTVPreferredFocus: this.props.hasTVPreferredFocus,
      tvParallaxProperties: this.props.tvParallaxProperties,
      hitSlop: this.props.hitSlop,
      onStartShouldSetResponder: this.touchableHandleStartShouldSetResponder,
      onResponderTerminationRequest: this.touchableHandleResponderTerminationRequest,
      onResponderGrant: this.touchableHandleResponderGrant,
      onResponderMove: this.touchableHandleResponderMove,
      onResponderRelease: this.touchableHandleResponderRelease,
      onResponderTerminate: this.touchableHandleResponderTerminate
    }, this.props.children, Touchable.renderDebugView({
      color: 'cyan',
      hitSlop: this.props.hitSlop
    }));
  }
});
module.exports = TouchableOpacity;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRvdWNoYWJsZU9wYWNpdHkuanMiXSwibmFtZXMiOlsiQW5pbWF0ZWQiLCJyZXF1aXJlIiwiRWFzaW5nIiwiTmF0aXZlTWV0aG9kc01peGluIiwiUGxhdGZvcm0iLCJSZWFjdCIsIlByb3BUeXBlcyIsIlRvdWNoYWJsZSIsIlRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayIsImNyZWF0ZVJlYWN0Q2xhc3MiLCJlbnN1cmVQb3NpdGl2ZURlbGF5UHJvcHMiLCJmbGF0dGVuU3R5bGUiLCJQUkVTU19SRVRFTlRJT05fT0ZGU0VUIiwidG9wIiwibGVmdCIsInJpZ2h0IiwiYm90dG9tIiwiVG91Y2hhYmxlT3BhY2l0eSIsImRpc3BsYXlOYW1lIiwibWl4aW5zIiwiTWl4aW4iLCJ3aXRob3V0RGVmYXVsdEZvY3VzQW5kQmx1ciIsInByb3BUeXBlcyIsImFjdGl2ZU9wYWNpdHkiLCJudW1iZXIiLCJoYXNUVlByZWZlcnJlZEZvY3VzIiwiYm9vbCIsInR2UGFyYWxsYXhQcm9wZXJ0aWVzIiwib2JqZWN0IiwiZ2V0RGVmYXVsdFByb3BzIiwiZ2V0SW5pdGlhbFN0YXRlIiwidG91Y2hhYmxlR2V0SW5pdGlhbFN0YXRlIiwiYW5pbSIsIlZhbHVlIiwiX2dldENoaWxkU3R5bGVPcGFjaXR5V2l0aERlZmF1bHQiLCJjb21wb25lbnREaWRNb3VudCIsInByb3BzIiwiVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMiLCJuZXh0UHJvcHMiLCJjb21wb25lbnREaWRVcGRhdGUiLCJwcmV2UHJvcHMiLCJwcmV2U3RhdGUiLCJkaXNhYmxlZCIsIl9vcGFjaXR5SW5hY3RpdmUiLCJzZXRPcGFjaXR5VG8iLCJ2YWx1ZSIsImR1cmF0aW9uIiwidGltaW5nIiwic3RhdGUiLCJ0b1ZhbHVlIiwiZWFzaW5nIiwiaW5PdXQiLCJxdWFkIiwidXNlTmF0aXZlRHJpdmVyIiwic3RhcnQiLCJ0b3VjaGFibGVIYW5kbGVBY3RpdmVQcmVzc0luIiwiZSIsImRpc3BhdGNoQ29uZmlnIiwicmVnaXN0cmF0aW9uTmFtZSIsIl9vcGFjaXR5QWN0aXZlIiwib25QcmVzc0luIiwidG91Y2hhYmxlSGFuZGxlQWN0aXZlUHJlc3NPdXQiLCJvblByZXNzT3V0IiwidG91Y2hhYmxlSGFuZGxlRm9jdXMiLCJpc1RWIiwib25Gb2N1cyIsInRvdWNoYWJsZUhhbmRsZUJsdXIiLCJvbkJsdXIiLCJ0b3VjaGFibGVIYW5kbGVQcmVzcyIsIm9uUHJlc3MiLCJ0b3VjaGFibGVIYW5kbGVMb25nUHJlc3MiLCJvbkxvbmdQcmVzcyIsInRvdWNoYWJsZUdldFByZXNzUmVjdE9mZnNldCIsInByZXNzUmV0ZW50aW9uT2Zmc2V0IiwidG91Y2hhYmxlR2V0SGl0U2xvcCIsImhpdFNsb3AiLCJ0b3VjaGFibGVHZXRIaWdobGlnaHREZWxheU1TIiwiZGVsYXlQcmVzc0luIiwidG91Y2hhYmxlR2V0TG9uZ1ByZXNzRGVsYXlNUyIsImRlbGF5TG9uZ1ByZXNzIiwidG91Y2hhYmxlR2V0UHJlc3NPdXREZWxheU1TIiwiZGVsYXlQcmVzc091dCIsImNoaWxkU3R5bGUiLCJzdHlsZSIsIm9wYWNpdHkiLCJyZW5kZXIiLCJhY2Nlc3NpYmxlIiwiYWNjZXNzaWJpbGl0eUxhYmVsIiwiYWNjZXNzaWJpbGl0eUhpbnQiLCJhY2Nlc3NpYmlsaXR5Um9sZSIsImFjY2Vzc2liaWxpdHlTdGF0ZXMiLCJuYXRpdmVJRCIsInRlc3RJRCIsIm9uTGF5b3V0IiwidG91Y2hhYmxlSGFuZGxlU3RhcnRTaG91bGRTZXRSZXNwb25kZXIiLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3QiLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJHcmFudCIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlck1vdmUiLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJSZWxlYXNlIiwidG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyVGVybWluYXRlIiwiY2hpbGRyZW4iLCJyZW5kZXJEZWJ1Z1ZpZXciLCJjb2xvciIsIm1vZHVsZSIsImV4cG9ydHMi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RSxNQUFBLG1CQUFtQixFQUFFLEtBQUt6RCxLQUFMLENBQVdYLG1CQVhsQztBQVlFLE1BQUEsb0JBQW9CLEVBQUUsS0FBS1csS0FBTCxDQUFXVCxvQkFabkM7QUFhRSxNQUFBLE9BQU8sRUFBRSxLQUFLUyxLQUFMLENBQVd1QyxPQWJ0QjtBQWlCRSxNQUFBLHlCQUF5QixFQUFFLEtBQUttQixzQ0FqQmxDO0FBa0JFLE1BQUEsNkJBQTZCLEVBSTNCLEtBQUtDLDBDQXRCVDtBQTJCRSxNQUFBLGdCQUFnQixFQUFFLEtBQUtDLDZCQTNCekI7QUErQkUsTUFBQSxlQUFlLEVBQUUsS0FBS0MsNEJBL0J4QjtBQW1DRSxNQUFBLGtCQUFrQixFQUFFLEtBQUtDLCtCQW5DM0I7QUF1Q0UsTUFBQSxvQkFBb0IsRUFBRSxLQUFLQztBQXZDN0IsT0F3Q0csS0FBSy9ELEtBQUwsQ0FBV2dFLFFBeENkLEVBeUNHN0YsU0FBUyxDQUFDOEYsZUFBVixDQUEwQjtBQUN6QkMsTUFBQUEsS0FBSyxFQUFFLE1BRGtCO0FBRXpCM0IsTUFBQUEsT0FBTyxFQUFFLEtBQUt2QyxLQUFMLENBQVd1QztBQUZLLEtBQTFCLENBekNILENBREY7QUFnREQ7QUFwTXlDLENBQUQsQ0FBM0M7QUF1TUE0QixNQUFNLENBQUNDLE9BQVAsR0FBaUJ2RixnQkFBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgRmFjZWJvb2ssIEluYy4gYW5kIGl0cyBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmb3JtYXRcbiAqIEBmbG93XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBBbmltYXRlZCA9IHJlcXVpcmUoJ0FuaW1hdGVkJyk7XG5jb25zdCBFYXNpbmcgPSByZXF1aXJlKCdFYXNpbmcnKTtcbmNvbnN0IE5hdGl2ZU1ldGhvZHNNaXhpbiA9IHJlcXVpcmUoJ05hdGl2ZU1ldGhvZHNNaXhpbicpO1xuY29uc3QgUGxhdGZvcm0gPSByZXF1aXJlKCdQbGF0Zm9ybScpO1xuY29uc3QgUmVhY3QgPSByZXF1aXJlKCdSZWFjdCcpO1xuY29uc3QgUHJvcFR5cGVzID0gcmVxdWlyZSgncHJvcC10eXBlcycpO1xuY29uc3QgVG91Y2hhYmxlID0gcmVxdWlyZSgnVG91Y2hhYmxlJyk7XG5jb25zdCBUb3VjaGFibGVXaXRob3V0RmVlZGJhY2sgPSByZXF1aXJlKCdUb3VjaGFibGVXaXRob3V0RmVlZGJhY2snKTtcblxuY29uc3QgY3JlYXRlUmVhY3RDbGFzcyA9IHJlcXVpcmUoJ2NyZWF0ZS1yZWFjdC1jbGFzcycpO1xuY29uc3QgZW5zdXJlUG9zaXRpdmVEZWxheVByb3BzID0gcmVxdWlyZSgnZW5zdXJlUG9zaXRpdmVEZWxheVByb3BzJyk7XG5jb25zdCBmbGF0dGVuU3R5bGUgPSByZXF1aXJlKCdmbGF0dGVuU3R5bGUnKTtcblxuaW1wb3J0IHR5cGUge1Byb3BzIGFzIFRvdWNoYWJsZVdpdGhvdXRGZWVkYmFja1Byb3BzfSBmcm9tICdUb3VjaGFibGVXaXRob3V0RmVlZGJhY2snO1xuaW1wb3J0IHR5cGUge1ZpZXdTdHlsZVByb3B9IGZyb20gJ1N0eWxlU2hlZXQnO1xuaW1wb3J0IHR5cGUge1RWUGFyYWxsYXhQcm9wZXJ0aWVzVHlwZX0gZnJvbSAnVFZWaWV3UHJvcFR5cGVzJztcbmltcG9ydCB0eXBlIHtQcmVzc0V2ZW50fSBmcm9tICdDb3JlRXZlbnRUeXBlcyc7XG5cbmNvbnN0IFBSRVNTX1JFVEVOVElPTl9PRkZTRVQgPSB7dG9wOiAyMCwgbGVmdDogMjAsIHJpZ2h0OiAyMCwgYm90dG9tOiAzMH07XG5cbnR5cGUgVFZQcm9wcyA9ICRSZWFkT25seTx7fFxuICBoYXNUVlByZWZlcnJlZEZvY3VzPzogP2Jvb2xlYW4sXG4gIHR2UGFyYWxsYXhQcm9wZXJ0aWVzPzogP1RWUGFyYWxsYXhQcm9wZXJ0aWVzVHlwZSxcbnx9PjtcblxudHlwZSBQcm9wcyA9ICRSZWFkT25seTx7fFxuICAuLi5Ub3VjaGFibGVXaXRob3V0RmVlZGJhY2tQcm9wcyxcbiAgLi4uVFZQcm9wcyxcbiAgYWN0aXZlT3BhY2l0eT86ID9udW1iZXIsXG4gIHN0eWxlPzogP1ZpZXdTdHlsZVByb3AsXG58fT47XG5cbi8qKlxuICogQSB3cmFwcGVyIGZvciBtYWtpbmcgdmlld3MgcmVzcG9uZCBwcm9wZXJseSB0byB0b3VjaGVzLlxuICogT24gcHJlc3MgZG93biwgdGhlIG9wYWNpdHkgb2YgdGhlIHdyYXBwZWQgdmlldyBpcyBkZWNyZWFzZWQsIGRpbW1pbmcgaXQuXG4gKlxuICogT3BhY2l0eSBpcyBjb250cm9sbGVkIGJ5IHdyYXBwaW5nIHRoZSBjaGlsZHJlbiBpbiBhbiBBbmltYXRlZC5WaWV3LCB3aGljaCBpc1xuICogYWRkZWQgdG8gdGhlIHZpZXcgaGllYXJjaHkuICBCZSBhd2FyZSB0aGF0IHRoaXMgY2FuIGFmZmVjdCBsYXlvdXQuXG4gKlxuICogRXhhbXBsZTpcbiAqXG4gKiBgYGBcbiAqIHJlbmRlckJ1dHRvbjogZnVuY3Rpb24oKSB7XG4gKiAgIHJldHVybiAoXG4gKiAgICAgPFRvdWNoYWJsZU9wYWNpdHkgb25QcmVzcz17dGhpcy5fb25QcmVzc0J1dHRvbn0+XG4gKiAgICAgICA8SW1hZ2VcbiAqICAgICAgICAgc3R5bGU9e3N0eWxlcy5idXR0b259XG4gKiAgICAgICAgIHNvdXJjZT17cmVxdWlyZSgnLi9teUJ1dHRvbi5wbmcnKX1cbiAqICAgICAgIC8+XG4gKiAgICAgPC9Ub3VjaGFibGVPcGFjaXR5PlxuICogICApO1xuICogfSxcbiAqIGBgYFxuICogIyMjIEV4YW1wbGVcbiAqXG4gKiBgYGBSZWFjdE5hdGl2ZVdlYlBsYXllclxuICogaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0J1xuICogaW1wb3J0IHtcbiAqICAgQXBwUmVnaXN0cnksXG4gKiAgIFN0eWxlU2hlZXQsXG4gKiAgIFRvdWNoYWJsZU9wYWNpdHksXG4gKiAgIFRleHQsXG4gKiAgIFZpZXcsXG4gKiB9IGZyb20gJ3JlYWN0LW5hdGl2ZSdcbiAqXG4gKiBjbGFzcyBBcHAgZXh0ZW5kcyBDb21wb25lbnQge1xuICogICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICogICAgIHN1cGVyKHByb3BzKVxuICogICAgIHRoaXMuc3RhdGUgPSB7IGNvdW50OiAwIH1cbiAqICAgfVxuICpcbiAqICAgb25QcmVzcyA9ICgpID0+IHtcbiAqICAgICB0aGlzLnNldFN0YXRlKHtcbiAqICAgICAgIGNvdW50OiB0aGlzLnN0YXRlLmNvdW50KzFcbiAqICAgICB9KVxuICogICB9XG4gKlxuICogIHJlbmRlcigpIHtcbiAqICAgIHJldHVybiAoXG4gKiAgICAgIDxWaWV3IHN0eWxlPXtzdHlsZXMuY29udGFpbmVyfT5cbiAqICAgICAgICA8VG91Y2hhYmxlT3BhY2l0eVxuICogICAgICAgICAgc3R5bGU9e3N0eWxlcy5idXR0b259XG4gKiAgICAgICAgICBvblByZXNzPXt0aGlzLm9uUHJlc3N9XG4gKiAgICAgICAgPlxuICogICAgICAgICAgPFRleHQ+IFRvdWNoIEhlcmUgPC9UZXh0PlxuICogICAgICAgIDwvVG91Y2hhYmxlT3BhY2l0eT5cbiAqICAgICAgICA8VmlldyBzdHlsZT17W3N0eWxlcy5jb3VudENvbnRhaW5lcl19PlxuICogICAgICAgICAgPFRleHQgc3R5bGU9e1tzdHlsZXMuY291bnRUZXh0XX0+XG4gKiAgICAgICAgICAgICB7IHRoaXMuc3RhdGUuY291bnQgIT09IDAgPyB0aGlzLnN0YXRlLmNvdW50OiBudWxsfVxuICogICAgICAgICAgIDwvVGV4dD5cbiAqICAgICAgICAgPC9WaWV3PlxuICogICAgICAgPC9WaWV3PlxuICogICAgIClcbiAqICAgfVxuICogfVxuICpcbiAqIGNvbnN0IHN0eWxlcyA9IFN0eWxlU2hlZXQuY3JlYXRlKHtcbiAqICAgY29udGFpbmVyOiB7XG4gKiAgICAgZmxleDogMSxcbiAqICAgICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsXG4gKiAgICAgcGFkZGluZ0hvcml6b250YWw6IDEwXG4gKiAgIH0sXG4gKiAgIGJ1dHRvbjoge1xuICogICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICogICAgIGJhY2tncm91bmRDb2xvcjogJyNEREREREQnLFxuICogICAgIHBhZGRpbmc6IDEwXG4gKiAgIH0sXG4gKiAgIGNvdW50Q29udGFpbmVyOiB7XG4gKiAgICAgYWxpZ25JdGVtczogJ2NlbnRlcicsXG4gKiAgICAgcGFkZGluZzogMTBcbiAqICAgfSxcbiAqICAgY291bnRUZXh0OiB7XG4gKiAgICAgY29sb3I6ICcjRkYwMEZGJ1xuICogICB9XG4gKiB9KVxuICpcbiAqIEFwcFJlZ2lzdHJ5LnJlZ2lzdGVyQ29tcG9uZW50KCdBcHAnLCAoKSA9PiBBcHApXG4gKiBgYGBcbiAqXG4gKi9cbmNvbnN0IFRvdWNoYWJsZU9wYWNpdHkgPSAoKGNyZWF0ZVJlYWN0Q2xhc3Moe1xuICBkaXNwbGF5TmFtZTogJ1RvdWNoYWJsZU9wYWNpdHknLFxuICBtaXhpbnM6IFtUb3VjaGFibGUuTWl4aW4ud2l0aG91dERlZmF1bHRGb2N1c0FuZEJsdXIsIE5hdGl2ZU1ldGhvZHNNaXhpbl0sXG5cbiAgcHJvcFR5cGVzOiB7XG4gICAgLyogJEZsb3dGaXhNZSg+PTAuODkuMCBzaXRlPXJlYWN0X25hdGl2ZV9mYikgVGhpcyBjb21tZW50IHN1cHByZXNzZXMgYW5cbiAgICAgKiBlcnJvciBmb3VuZCB3aGVuIEZsb3cgdjAuODkgd2FzIGRlcGxveWVkLiBUbyBzZWUgdGhlIGVycm9yLCBkZWxldGUgdGhpc1xuICAgICAqIGNvbW1lbnQgYW5kIHJ1biBGbG93LiAqL1xuICAgIC4uLlRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjay5wcm9wVHlwZXMsXG4gICAgLyoqXG4gICAgICogRGV0ZXJtaW5lcyB3aGF0IHRoZSBvcGFjaXR5IG9mIHRoZSB3cmFwcGVkIHZpZXcgc2hvdWxkIGJlIHdoZW4gdG91Y2ggaXNcbiAgICAgKiBhY3RpdmUuIERlZmF1bHRzIHRvIDAuMi5cbiAgICAgKi9cbiAgICBhY3RpdmVPcGFjaXR5OiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIC8qKlxuICAgICAqIFRWIHByZWZlcnJlZCBmb2N1cyAoc2VlIGRvY3VtZW50YXRpb24gZm9yIHRoZSBWaWV3IGNvbXBvbmVudCkuXG4gICAgICovXG4gICAgaGFzVFZQcmVmZXJyZWRGb2N1czogUHJvcFR5cGVzLmJvb2wsXG4gICAgLyoqXG4gICAgICogQXBwbGUgVFYgcGFyYWxsYXggZWZmZWN0c1xuICAgICAqL1xuICAgIHR2UGFyYWxsYXhQcm9wZXJ0aWVzOiBQcm9wVHlwZXMub2JqZWN0LFxuICB9LFxuXG4gIGdldERlZmF1bHRQcm9wczogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFjdGl2ZU9wYWNpdHk6IDAuMixcbiAgICB9O1xuICB9LFxuXG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8qICRGbG93Rml4TWUoPj0wLjg5LjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIpIFRoaXMgY29tbWVudCBzdXBwcmVzc2VzIGFuXG4gICAgICAgKiBlcnJvciBmb3VuZCB3aGVuIEZsb3cgdjAuODkgd2FzIGRlcGxveWVkLiBUbyBzZWUgdGhlIGVycm9yLCBkZWxldGVcbiAgICAgICAqIHRoaXMgY29tbWVudCBhbmQgcnVuIEZsb3cuICovXG4gICAgICAuLi50aGlzLnRvdWNoYWJsZUdldEluaXRpYWxTdGF0ZSgpLFxuICAgICAgLyogJEZsb3dGaXhNZSg+PTAuODkuMCBzaXRlPXJlYWN0X25hdGl2ZV9mYikgVGhpcyBjb21tZW50IHN1cHByZXNzZXMgYW5cbiAgICAgICAqIGVycm9yIGZvdW5kIHdoZW4gRmxvdyB2MC44OSB3YXMgZGVwbG95ZWQuIFRvIHNlZSB0aGUgZXJyb3IsIGRlbGV0ZVxuICAgICAgICogdGhpcyBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgICAgIGFuaW06IG5ldyBBbmltYXRlZC5WYWx1ZSh0aGlzLl9nZXRDaGlsZFN0eWxlT3BhY2l0eVdpdGhEZWZhdWx0KCkpLFxuICAgIH07XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIGVuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcyh0aGlzLnByb3BzKTtcbiAgfSxcblxuICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wczogZnVuY3Rpb24obmV4dFByb3BzKSB7XG4gICAgZW5zdXJlUG9zaXRpdmVEZWxheVByb3BzKG5leHRQcm9wcyk7XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkVXBkYXRlOiBmdW5jdGlvbihwcmV2UHJvcHMsIHByZXZTdGF0ZSkge1xuICAgIGlmICh0aGlzLnByb3BzLmRpc2FibGVkICE9PSBwcmV2UHJvcHMuZGlzYWJsZWQpIHtcbiAgICAgIHRoaXMuX29wYWNpdHlJbmFjdGl2ZSgyNTApO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogQW5pbWF0ZSB0aGUgdG91Y2hhYmxlIHRvIGEgbmV3IG9wYWNpdHkuXG4gICAqL1xuICBzZXRPcGFjaXR5VG86IGZ1bmN0aW9uKHZhbHVlOiBudW1iZXIsIGR1cmF0aW9uOiBudW1iZXIpIHtcbiAgICBBbmltYXRlZC50aW1pbmcodGhpcy5zdGF0ZS5hbmltLCB7XG4gICAgICB0b1ZhbHVlOiB2YWx1ZSxcbiAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbixcbiAgICAgIGVhc2luZzogRWFzaW5nLmluT3V0KEVhc2luZy5xdWFkKSxcbiAgICAgIHVzZU5hdGl2ZURyaXZlcjogdHJ1ZSxcbiAgICB9KS5zdGFydCgpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBgVG91Y2hhYmxlLk1peGluYCBzZWxmIGNhbGxiYWNrcy4gVGhlIG1peGluIHdpbGwgaW52b2tlIHRoZXNlIGlmIHRoZXkgYXJlXG4gICAqIGRlZmluZWQgb24geW91ciBjb21wb25lbnQuXG4gICAqL1xuICB0b3VjaGFibGVIYW5kbGVBY3RpdmVQcmVzc0luOiBmdW5jdGlvbihlOiBQcmVzc0V2ZW50KSB7XG4gICAgaWYgKGUuZGlzcGF0Y2hDb25maWcucmVnaXN0cmF0aW9uTmFtZSA9PT0gJ29uUmVzcG9uZGVyR3JhbnQnKSB7XG4gICAgICB0aGlzLl9vcGFjaXR5QWN0aXZlKDApO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9vcGFjaXR5QWN0aXZlKDE1MCk7XG4gICAgfVxuICAgIHRoaXMucHJvcHMub25QcmVzc0luICYmIHRoaXMucHJvcHMub25QcmVzc0luKGUpO1xuICB9LFxuXG4gIHRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzT3V0OiBmdW5jdGlvbihlOiBQcmVzc0V2ZW50KSB7XG4gICAgdGhpcy5fb3BhY2l0eUluYWN0aXZlKDI1MCk7XG4gICAgdGhpcy5wcm9wcy5vblByZXNzT3V0ICYmIHRoaXMucHJvcHMub25QcmVzc091dChlKTtcbiAgfSxcblxuICB0b3VjaGFibGVIYW5kbGVGb2N1czogZnVuY3Rpb24oZTogRXZlbnQpIHtcbiAgICBpZiAoUGxhdGZvcm0uaXNUVikge1xuICAgICAgdGhpcy5fb3BhY2l0eUFjdGl2ZSgxNTApO1xuICAgIH1cbiAgICB0aGlzLnByb3BzLm9uRm9jdXMgJiYgdGhpcy5wcm9wcy5vbkZvY3VzKGUpO1xuICB9LFxuXG4gIHRvdWNoYWJsZUhhbmRsZUJsdXI6IGZ1bmN0aW9uKGU6IEV2ZW50KSB7XG4gICAgaWYgKFBsYXRmb3JtLmlzVFYpIHtcbiAgICAgIHRoaXMuX29wYWNpdHlJbmFjdGl2ZSgyNTApO1xuICAgIH1cbiAgICB0aGlzLnByb3BzLm9uQmx1ciAmJiB0aGlzLnByb3BzLm9uQmx1cihlKTtcbiAgfSxcblxuICB0b3VjaGFibGVIYW5kbGVQcmVzczogZnVuY3Rpb24oZTogUHJlc3NFdmVudCkge1xuICAgIHRoaXMucHJvcHMub25QcmVzcyAmJiB0aGlzLnByb3BzLm9uUHJlc3MoZSk7XG4gIH0sXG5cbiAgdG91Y2hhYmxlSGFuZGxlTG9uZ1ByZXNzOiBmdW5jdGlvbihlOiBQcmVzc0V2ZW50KSB7XG4gICAgdGhpcy5wcm9wcy5vbkxvbmdQcmVzcyAmJiB0aGlzLnByb3BzLm9uTG9uZ1ByZXNzKGUpO1xuICB9LFxuXG4gIHRvdWNoYWJsZUdldFByZXNzUmVjdE9mZnNldDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMucHJlc3NSZXRlbnRpb25PZmZzZXQgfHwgUFJFU1NfUkVURU5USU9OX09GRlNFVDtcbiAgfSxcblxuICB0b3VjaGFibGVHZXRIaXRTbG9wOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5oaXRTbG9wO1xuICB9LFxuXG4gIHRvdWNoYWJsZUdldEhpZ2hsaWdodERlbGF5TVM6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnByb3BzLmRlbGF5UHJlc3NJbiB8fCAwO1xuICB9LFxuXG4gIHRvdWNoYWJsZUdldExvbmdQcmVzc0RlbGF5TVM6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnByb3BzLmRlbGF5TG9uZ1ByZXNzID09PSAwXG4gICAgICA/IDBcbiAgICAgIDogdGhpcy5wcm9wcy5kZWxheUxvbmdQcmVzcyB8fCA1MDA7XG4gIH0sXG5cbiAgdG91Y2hhYmxlR2V0UHJlc3NPdXREZWxheU1TOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5kZWxheVByZXNzT3V0O1xuICB9LFxuXG4gIF9vcGFjaXR5QWN0aXZlOiBmdW5jdGlvbihkdXJhdGlvbjogbnVtYmVyKSB7XG4gICAgdGhpcy5zZXRPcGFjaXR5VG8odGhpcy5wcm9wcy5hY3RpdmVPcGFjaXR5LCBkdXJhdGlvbik7XG4gIH0sXG5cbiAgX29wYWNpdHlJbmFjdGl2ZTogZnVuY3Rpb24oZHVyYXRpb246IG51bWJlcikge1xuICAgIC8qICRGbG93Rml4TWUoPj0wLjg5LjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIpIFRoaXMgY29tbWVudCBzdXBwcmVzc2VzIGFuXG4gICAgICogZXJyb3IgZm91bmQgd2hlbiBGbG93IHYwLjg5IHdhcyBkZXBsb3llZC4gVG8gc2VlIHRoZSBlcnJvciwgZGVsZXRlIHRoaXNcbiAgICAgKiBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgICB0aGlzLnNldE9wYWNpdHlUbyh0aGlzLl9nZXRDaGlsZFN0eWxlT3BhY2l0eVdpdGhEZWZhdWx0KCksIGR1cmF0aW9uKTtcbiAgfSxcblxuICBfZ2V0Q2hpbGRTdHlsZU9wYWNpdHlXaXRoRGVmYXVsdDogZnVuY3Rpb24oKSB7XG4gICAgY29uc3QgY2hpbGRTdHlsZSA9IGZsYXR0ZW5TdHlsZSh0aGlzLnByb3BzLnN0eWxlKSB8fCB7fTtcbiAgICByZXR1cm4gY2hpbGRTdHlsZS5vcGFjaXR5ID09IG51bGwgPyAxIDogY2hpbGRTdHlsZS5vcGFjaXR5O1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxBbmltYXRlZC5WaWV3XG4gICAgICAgIGFjY2Vzc2libGU9e3RoaXMucHJvcHMuYWNjZXNzaWJsZSAhPT0gZmFsc2V9XG4gICAgICAgIGFjY2Vzc2liaWxpdHlMYWJlbD17dGhpcy5wcm9wcy5hY2Nlc3NpYmlsaXR5TGFiZWx9XG4gICAgICAgIGFjY2Vzc2liaWxpdHlIaW50PXt0aGlzLnByb3BzLmFjY2Vzc2liaWxpdHlIaW50fVxuICAgICAgICBhY2Nlc3NpYmlsaXR5Um9sZT17dGhpcy5wcm9wcy5hY2Nlc3NpYmlsaXR5Um9sZX1cbiAgICAgICAgYWNjZXNzaWJpbGl0eVN0YXRlcz17dGhpcy5wcm9wcy5hY2Nlc3NpYmlsaXR5U3RhdGVzfVxuICAgICAgICBzdHlsZT17W3RoaXMucHJvcHMuc3R5bGUsIHtvcGFjaXR5OiB0aGlzLnN0YXRlLmFuaW19XX1cbiAgICAgICAgbmF0aXZlSUQ9e3RoaXMucHJvcHMubmF0aXZlSUR9XG4gICAgICAgIHRlc3RJRD17dGhpcy5wcm9wcy50ZXN0SUR9XG4gICAgICAgIG9uTGF5b3V0PXt0aGlzLnByb3BzLm9uTGF5b3V0fVxuICAgICAgICBpc1RWU2VsZWN0YWJsZT17dHJ1ZX1cbiAgICAgICAgaGFzVFZQcmVmZXJyZWRGb2N1cz17dGhpcy5wcm9wcy5oYXNUVlByZWZlcnJlZEZvY3VzfVxuICAgICAgICB0dlBhcmFsbGF4UHJvcGVydGllcz17dGhpcy5wcm9wcy50dlBhcmFsbGF4UHJvcGVydGllc31cbiAgICAgICAgaGl0U2xvcD17dGhpcy5wcm9wcy5oaXRTbG9wfVxuICAgICAgICAvKiAkRmxvd0ZpeE1lKD49MC44OS4wIHNpdGU9cmVhY3RfbmF0aXZlX2ZiKSBUaGlzIGNvbW1lbnQgc3VwcHJlc3NlcyBhblxuICAgICAgICAgKiBlcnJvciBmb3VuZCB3aGVuIEZsb3cgdjAuODkgd2FzIGRlcGxveWVkLiBUbyBzZWUgdGhlIGVycm9yLCBkZWxldGVcbiAgICAgICAgICogdGhpcyBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgICAgICAgb25TdGFydFNob3VsZFNldFJlc3BvbmRlcj17dGhpcy50b3VjaGFibGVIYW5kbGVTdGFydFNob3VsZFNldFJlc3BvbmRlcn1cbiAgICAgICAgb25SZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3Q9e1xuICAgICAgICAgIC8qICRGbG93Rml4TWUoPj0wLjg5LjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIpIFRoaXMgY29tbWVudCBzdXBwcmVzc2VzXG4gICAgICAgICAgICogYW4gZXJyb3IgZm91bmQgd2hlbiBGbG93IHYwLjg5IHdhcyBkZXBsb3llZC4gVG8gc2VlIHRoZSBlcnJvcixcbiAgICAgICAgICAgKiBkZWxldGUgdGhpcyBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgICAgICAgICB0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdFxuICAgICAgICB9XG4gICAgICAgIC8qICRGbG93Rml4TWUoPj0wLjg5LjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIpIFRoaXMgY29tbWVudCBzdXBwcmVzc2VzIGFuXG4gICAgICAgICAqIGVycm9yIGZvdW5kIHdoZW4gRmxvdyB2MC44OSB3YXMgZGVwbG95ZWQuIFRvIHNlZSB0aGUgZXJyb3IsIGRlbGV0ZVxuICAgICAgICAgKiB0aGlzIGNvbW1lbnQgYW5kIHJ1biBGbG93LiAqL1xuICAgICAgICBvblJlc3BvbmRlckdyYW50PXt0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlckdyYW50fVxuICAgICAgICAvKiAkRmxvd0ZpeE1lKD49MC44OS4wIHNpdGU9cmVhY3RfbmF0aXZlX2ZiKSBUaGlzIGNvbW1lbnQgc3VwcHJlc3NlcyBhblxuICAgICAgICAgKiBlcnJvciBmb3VuZCB3aGVuIEZsb3cgdjAuODkgd2FzIGRlcGxveWVkLiBUbyBzZWUgdGhlIGVycm9yLCBkZWxldGVcbiAgICAgICAgICogdGhpcyBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgICAgICAgb25SZXNwb25kZXJNb3ZlPXt0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlck1vdmV9XG4gICAgICAgIC8qICRGbG93Rml4TWUoPj0wLjg5LjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIpIFRoaXMgY29tbWVudCBzdXBwcmVzc2VzIGFuXG4gICAgICAgICAqIGVycm9yIGZvdW5kIHdoZW4gRmxvdyB2MC44OSB3YXMgZGVwbG95ZWQuIFRvIHNlZSB0aGUgZXJyb3IsIGRlbGV0ZVxuICAgICAgICAgKiB0aGlzIGNvbW1lbnQgYW5kIHJ1biBGbG93LiAqL1xuICAgICAgICBvblJlc3BvbmRlclJlbGVhc2U9e3RoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyUmVsZWFzZX1cbiAgICAgICAgLyogJEZsb3dGaXhNZSg+PTAuODkuMCBzaXRlPXJlYWN0X25hdGl2ZV9mYikgVGhpcyBjb21tZW50IHN1cHByZXNzZXMgYW5cbiAgICAgICAgICogZXJyb3IgZm91bmQgd2hlbiBGbG93IHYwLjg5IHdhcyBkZXBsb3llZC4gVG8gc2VlIHRoZSBlcnJvciwgZGVsZXRlXG4gICAgICAgICAqIHRoaXMgY29tbWVudCBhbmQgcnVuIEZsb3cuICovXG4gICAgICAgIG9uUmVzcG9uZGVyVGVybWluYXRlPXt0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0ZX0+XG4gICAgICAgIHt0aGlzLnByb3BzLmNoaWxkcmVufVxuICAgICAgICB7VG91Y2hhYmxlLnJlbmRlckRlYnVnVmlldyh7XG4gICAgICAgICAgY29sb3I6ICdjeWFuJyxcbiAgICAgICAgICBoaXRTbG9wOiB0aGlzLnByb3BzLmhpdFNsb3AsXG4gICAgICAgIH0pfVxuICAgICAgPC9BbmltYXRlZC5WaWV3PlxuICAgICk7XG4gIH0sXG59KTogYW55KTogUmVhY3QuQ29tcG9uZW50VHlwZTxQcm9wcz4pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRvdWNoYWJsZU9wYWNpdHk7XG4iXX0=