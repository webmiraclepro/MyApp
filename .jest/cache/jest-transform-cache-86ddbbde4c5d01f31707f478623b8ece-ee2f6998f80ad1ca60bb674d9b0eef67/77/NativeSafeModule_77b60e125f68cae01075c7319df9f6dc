d99b74c77d78bc5e7cd0dc1ddb5c3bd1
var _extends = Object.assign || function (target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i];

    for (var key in source) {
      if (Object.prototype.hasOwnProperty.call(source, key)) {
        target[key] = source[key];
      }
    }
  }

  return target;
};

var _templateObject = _taggedTemplateLiteral(['\n      SafeModule.module(...) was invoked without any options parameter.\n    '], ['\n      SafeModule.module(...) was invoked without any options parameter.\n    ']),
    _templateObject2 = _taggedTemplateLiteral(['\n      SafeModule.module(...) requires a moduleName property to be specified.\n    '], ['\n      SafeModule.module(...) requires a moduleName property to be specified.\n    ']),
    _templateObject3 = _taggedTemplateLiteral(['\n      Missing a "mock" parameter.\n    '], ['\n      Missing a "mock" parameter.\n    ']),
    _templateObject4 = _taggedTemplateLiteral(['\n          ReactNative.NativeModules.', '.', ' did not have a corresponding prop defined\n          in the mock provided to SafeModule.\n        '], ['\n          ReactNative.NativeModules.', '.', ' did not have a corresponding prop defined\n          in the mock provided to SafeModule.\n        ']);

var _reactNative = require('react-native');

var _dedent = require('dedent');

var _dedent2 = _interopRequireDefault(_dedent);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _taggedTemplateLiteral(strings, raw) {
  return Object.freeze(Object.defineProperties(strings, {
    raw: {
      value: Object.freeze(raw)
    }
  }));
}

var hasOwnProperty = Object.prototype.hasOwnProperty;
var UNMOCKED_PROPERTY_WHITELIST = {
  VERSION: true,
  addListener: true,
  removeListeners: true
};
var eventEmitterMock = {
  addListener: function addListener() {},
  removeListeners: function removeListeners() {}
};

var first = function first(array, fn) {
  var result = void 0;
  var i = 0;

  for (; i < array.length; i++) {
    result = fn(array[i]);
    if (result) return result;
  }

  return null;
};

var moduleWithName = function moduleWithName(nameOrArray) {
  if (!nameOrArray) return null;
  if (Array.isArray(nameOrArray)) return first(nameOrArray, moduleWithName);
  return _reactNative.NativeModules[nameOrArray];
};

var getPrimaryName = function getPrimaryName(nameOrArray) {
  return Array.isArray(nameOrArray) ? getPrimaryName(nameOrArray[0]) : nameOrArray;
};

var getModule = function getModule(moduleNameOrNames, mock, isEventEmitter) {
  var module = moduleWithName(moduleNameOrNames);
  if (module) return module;
  if (isEventEmitter) return _extends({}, mock, eventEmitterMock);
  return mock;
};

var defaultGetVersion = function defaultGetVersion(module) {
  return module.VERSION;
};

var create = function SafeModuleCreate(options) {
  if (!options) {
    throw new Error((0, _dedent2.default)(_templateObject));
  }

  var moduleName = options.moduleName;
  var mock = options.mock;
  var isEventEmitter = options.isEventEmitter;
  var versionOverrides = options.versionOverrides;
  var getVersion = options.getVersion;

  if (!getVersion) {
    getVersion = defaultGetVersion;
  }

  if (!moduleName) {
    throw new Error((0, _dedent2.default)(_templateObject2));
  }

  var MODULE_NAME = getPrimaryName(moduleName);

  if (!mock) {
    throw new Error((0, _dedent2.default)(_templateObject3));
  }

  var result = {};
  var module = getModule(moduleName, mock, isEventEmitter);
  var version = getVersion(module);

  if (__DEV__) {
    Object.keys(module).forEach(function (key) {
      if (!hasOwnProperty.call(mock, key) && !UNMOCKED_PROPERTY_WHITELIST[key]) {
        console.warn((0, _dedent2.default)(_templateObject4, MODULE_NAME, key));
      }
    });
  }

  if (isEventEmitter) {
    result.emitter = new _reactNative.NativeEventEmitter(module);
  }

  var overrides = void 0;
  var boundOverrides = void 0;

  if (versionOverrides) {
    overrides = versionOverrides[version];
    boundOverrides = {};

    if (overrides) {
      Object.keys(overrides).forEach(function (key) {
        if (typeof overrides[key] === 'function') {
          boundOverrides[key] = overrides[key](module[key], module);
        } else {
          boundOverrides[key] = overrides[key];
        }
      });
    }
  }

  _extends(result, mock, module, boundOverrides);

  return result;
};

module.exports = create;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk5hdGl2ZVNhZmVNb2R1bGUuanMiXSwibmFtZXMiOlsiX2V4dGVuZHMiLCJPYmplY3QiLCJhc3NpZ24iLCJ0YXJnZXQiLCJpIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwic291cmNlIiwia2V5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiX3RlbXBsYXRlT2JqZWN0IiwiX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbCIsIl90ZW1wbGF0ZU9iamVjdDIiLCJfdGVtcGxhdGVPYmplY3QzIiwiX3RlbXBsYXRlT2JqZWN0NCIsIl9yZWFjdE5hdGl2ZSIsInJlcXVpcmUiLCJfZGVkZW50IiwiX2RlZGVudDIiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJzdHJpbmdzIiwicmF3IiwiZnJlZXplIiwiZGVmaW5lUHJvcGVydGllcyIsInZhbHVlIiwiVU5NT0NLRURfUFJPUEVSVFlfV0hJVEVMSVNUIiwiVkVSU0lPTiIsImFkZExpc3RlbmVyIiwicmVtb3ZlTGlzdGVuZXJzIiwiZXZlbnRFbWl0dGVyTW9jayIsImZpcnN0IiwiYXJyYXkiLCJmbiIsInJlc3VsdCIsIm1vZHVsZVdpdGhOYW1lIiwibmFtZU9yQXJyYXkiLCJBcnJheSIsImlzQXJyYXkiLCJOYXRpdmVNb2R1bGVzIiwiZ2V0UHJpbWFyeU5hbWUiLCJnZXRNb2R1bGUiLCJtb2R1bGVOYW1lT3JOYW1lcyIsIm1vY2siLCJpc0V2ZW50RW1pdHRlciIsIm1vZHVsZSIsImRlZmF1bHRHZXRWZXJzaW9uIiwiY3JlYXRlIiwiU2FmZU1vZHVsZUNyZWF0ZSIsIm9wdGlvbnMiLCJFcnJvciIsIm1vZHVsZU5hbWUiLCJ2ZXJzaW9uT3ZlcnJpZGVzIiwiZ2V0VmVyc2lvbiIsIk1PRFVMRV9OQU1FIiwidmVyc2lvbiIsIl9fREVWX18iLCJrZXlzIiwiZm9yRWFjaCIsImNvbnNvbGUiLCJ3YXJuIiwiZW1pdHRlciIsIk5hdGl2ZUV2ZW50RW1pdHRlciIs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RCxTQUFTLENBQUMzRCxHQUFELENBQTdCO0FBQ0M7QUFDQSxPQU5EO0FBT0M7QUFDQTs7QUFFRFIsRUFBQUEsUUFBUSxDQUNSc0MsTUFEUSxFQUVSUyxJQUZRLEVBR1JFLE1BSFEsRUFJUm1CLGNBSlEsQ0FBUjs7QUFPQSxTQUFPOUIsTUFBUDtBQUNDLENBOUVEOztBQWdGQVcsTUFBTSxDQUFDb0IsT0FBUCxHQUFlbEIsTUFBZiIsInNvdXJjZXNDb250ZW50IjpbInZhciBfZXh0ZW5kcz1PYmplY3QuYXNzaWdufHxmdW5jdGlvbih0YXJnZXQpe2Zvcih2YXIgaT0xO2k8YXJndW1lbnRzLmxlbmd0aDtpKyspe3ZhciBzb3VyY2U9YXJndW1lbnRzW2ldO2Zvcih2YXIga2V5IGluIHNvdXJjZSl7aWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSxrZXkpKXt0YXJnZXRba2V5XT1zb3VyY2Vba2V5XTt9fX1yZXR1cm4gdGFyZ2V0O307dmFyIF90ZW1wbGF0ZU9iamVjdD1fdGFnZ2VkVGVtcGxhdGVMaXRlcmFsKFsnXFxuICAgICAgU2FmZU1vZHVsZS5tb2R1bGUoLi4uKSB3YXMgaW52b2tlZCB3aXRob3V0IGFueSBvcHRpb25zIHBhcmFtZXRlci5cXG4gICAgJ10sWydcXG4gICAgICBTYWZlTW9kdWxlLm1vZHVsZSguLi4pIHdhcyBpbnZva2VkIHdpdGhvdXQgYW55IG9wdGlvbnMgcGFyYW1ldGVyLlxcbiAgICAnXSksX3RlbXBsYXRlT2JqZWN0Mj1fdGFnZ2VkVGVtcGxhdGVMaXRlcmFsKFsnXFxuICAgICAgU2FmZU1vZHVsZS5tb2R1bGUoLi4uKSByZXF1aXJlcyBhIG1vZHVsZU5hbWUgcHJvcGVydHkgdG8gYmUgc3BlY2lmaWVkLlxcbiAgICAnXSxbJ1xcbiAgICAgIFNhZmVNb2R1bGUubW9kdWxlKC4uLikgcmVxdWlyZXMgYSBtb2R1bGVOYW1lIHByb3BlcnR5IHRvIGJlIHNwZWNpZmllZC5cXG4gICAgJ10pLF90ZW1wbGF0ZU9iamVjdDM9X3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbChbJ1xcbiAgICAgIE1pc3NpbmcgYSBcIm1vY2tcIiBwYXJhbWV0ZXIuXFxuICAgICddLFsnXFxuICAgICAgTWlzc2luZyBhIFwibW9ja1wiIHBhcmFtZXRlci5cXG4gICAgJ10pLF90ZW1wbGF0ZU9iamVjdDQ9X3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbChbJ1xcbiAgICAgICAgICBSZWFjdE5hdGl2ZS5OYXRpdmVNb2R1bGVzLicsJy4nLCcgZGlkIG5vdCBoYXZlIGEgY29ycmVzcG9uZGluZyBwcm9wIGRlZmluZWRcXG4gICAgICAgICAgaW4gdGhlIG1vY2sgcHJvdmlkZWQgdG8gU2FmZU1vZHVsZS5cXG4gICAgICAgICddLFsnXFxuICAgICAgICAgIFJlYWN0TmF0aXZlLk5hdGl2ZU1vZHVsZXMuJywnLicsJyBkaWQgbm90IGhhdmUgYSBjb3JyZXNwb25kaW5nIHByb3AgZGVmaW5lZFxcbiAgICAgICAgICBpbiB0aGUgbW9jayBwcm92aWRlZCB0byBTYWZlTW9kdWxlLlxcbiAgICAgICAgJ10pO3ZhciBfcmVhY3ROYXRpdmU9cmVxdWlyZSgncmVhY3QtbmF0aXZlJyk7XG52YXIgX2RlZGVudD1yZXF1aXJlKCdkZWRlbnQnKTt2YXIgX2RlZGVudDI9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGVkZW50KTtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iail7cmV0dXJuIG9iaiYmb2JqLl9fZXNNb2R1bGU/b2JqOntkZWZhdWx0Om9ian07fWZ1bmN0aW9uIF90YWdnZWRUZW1wbGF0ZUxpdGVyYWwoc3RyaW5ncyxyYXcpe3JldHVybiBPYmplY3QuZnJlZXplKE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHN0cmluZ3Mse3Jhdzp7dmFsdWU6T2JqZWN0LmZyZWV6ZShyYXcpfX0pKTt9XG5cbi8vIGNvbnN0IEFjY291bnRNb2R1bGUgPSBTYWZlTW9kdWxlLmNyZWF0ZSh7XG4vLyAgIG1vZHVsZU5hbWU6IFsnU29tZU5hdGl2ZU1vZHVsZScsICdTb21lT2xkTmFtZU9mVGhhdE1vZHVsZSddLFxuLy8gICBpc0V2ZW50RW1pdHRlcjogdHJ1ZSxcbi8vICAgZ2V0VmVyc2lvbjogbW9kdWxlID0+IG1vZHVsZS5WRVJTSU9OLFxuLy8gICBvbkluaXQ6IChtb2R1bGUsIHZlcnNpb24pID0+IHt9LFxuLy8gICBvbk5vTW9kdWxlRm91bmQ6ICgpID0+IHt9LFxuLy8gICBvblZlcnNpb25Gb3VuZDogKHZlcnNpb24pID0+IHt9LFxuLy8gICBvbk92ZXJyaWRlVXNlZDogKHZlcnNpb24sIG92ZXJyaWRlTmFtZSkgPT4ge30sXG4vLyAgIG9uT3ZlcnJpZGVDYWxsZWQ6ICh2ZXJzaW9uLCBvdmVycmlkZU5hbWUpID0+IHt9LFxuLy8gICBtb2NrOiB7XG4vLyAgICAgcHVzaDogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCksXG4vLyAgICAgcHVzaE5hdGl2ZTogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCksXG4vLyAgICAgc2V0VGl0bGU6IG5vb3AsXG4vLyAgIH0sXG4vLyAgIG92ZXJyaWRlczoge1xuLy8gICAgIDc6IHtcbi8vICAgICAgIHB1c2g6IG9sZCA9PiAoaWQsIHByb3BzLCBvcHRpb25zKSA9PiB7XG4vLyAgICAgICAgIHJldHVybiBvbGQoaWQsIHByb3BzLCAhIW9wdGlvbnMuYW5pbWF0ZWQpO1xuLy8gICAgICAgfSxcbi8vICAgICB9LFxuLy8gICB9LFxuLy8gfSk7XG5cbnZhciBoYXNPd25Qcm9wZXJ0eT1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuXG52YXIgVU5NT0NLRURfUFJPUEVSVFlfV0hJVEVMSVNUPXtcblZFUlNJT046dHJ1ZSxcbmFkZExpc3RlbmVyOnRydWUsXG5yZW1vdmVMaXN0ZW5lcnM6dHJ1ZX07XG5cblxudmFyIGV2ZW50RW1pdHRlck1vY2s9e1xuYWRkTGlzdGVuZXI6ZnVuY3Rpb24gYWRkTGlzdGVuZXIoKXt9LFxucmVtb3ZlTGlzdGVuZXJzOmZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVycygpe319O1xuXG5cbnZhciBmaXJzdD1mdW5jdGlvbiBmaXJzdChhcnJheSxmbil7XG52YXIgcmVzdWx0PXZvaWQgMDtcbnZhciBpPTA7XG4vKiBlc2xpbnQgbm8tcGx1c3BsdXM6IDAgKi9cbmZvcig7aTxhcnJheS5sZW5ndGg7aSsrKXtcbnJlc3VsdD1mbihhcnJheVtpXSk7XG5pZihyZXN1bHQpcmV0dXJuIHJlc3VsdDtcbn1cbnJldHVybiBudWxsO1xufTtcblxudmFyIG1vZHVsZVdpdGhOYW1lPWZ1bmN0aW9uIG1vZHVsZVdpdGhOYW1lKG5hbWVPckFycmF5KXtcbmlmKCFuYW1lT3JBcnJheSlyZXR1cm4gbnVsbDtcbmlmKEFycmF5LmlzQXJyYXkobmFtZU9yQXJyYXkpKXJldHVybiBmaXJzdChuYW1lT3JBcnJheSxtb2R1bGVXaXRoTmFtZSk7XG5yZXR1cm4gX3JlYWN0TmF0aXZlLk5hdGl2ZU1vZHVsZXNbbmFtZU9yQXJyYXldO1xufTtcblxudmFyIGdldFByaW1hcnlOYW1lPWZ1bmN0aW9uIGdldFByaW1hcnlOYW1lKG5hbWVPckFycmF5KXtcbnJldHVybiBBcnJheS5pc0FycmF5KG5hbWVPckFycmF5KT9nZXRQcmltYXJ5TmFtZShuYW1lT3JBcnJheVswXSk6bmFtZU9yQXJyYXk7XG59O1xuXG52YXIgZ2V0TW9kdWxlPWZ1bmN0aW9uIGdldE1vZHVsZShtb2R1bGVOYW1lT3JOYW1lcyxtb2NrLGlzRXZlbnRFbWl0dGVyKXtcbnZhciBtb2R1bGU9bW9kdWxlV2l0aE5hbWUobW9kdWxlTmFtZU9yTmFtZXMpO1xuLy8gVE9ETzogaW4gX19ERVZfXywgd2Ugc2hvdWxkIGNvbnNvbGUud2FybiBpZiBhbnl0aGluZyBidXQgdGhlIGZpcnN0IG1vZHVsZSBnb3QgdXNlZC5cbmlmKG1vZHVsZSlyZXR1cm4gbW9kdWxlO1xuLy8gRm9yIFBsYXRmb3JtLk9TID09PSAnaW9zJywgd2UgbXVzdCBlbnN1cmUgdGhhdCBgbW9kdWxlYCBjb250YWlucyBldmVudFxuLy8gZW1pdHRlciBtZXRob2RzIGV4cGVjdGVkIGJ5IGBOYXRpdmVFdmVudEVtaXR0ZXJgLCBldmVuIGluIHRoZSBjYXNlIG9mIGFcbi8vIG1vY2suIE90aGVyd2lzZSwgY2FsbGluZyB0aGUgZW1pdHRlciB3aWxsIHRocm93IGFuIGVycm9yLlxuaWYoaXNFdmVudEVtaXR0ZXIpcmV0dXJuIF9leHRlbmRzKHt9LG1vY2ssZXZlbnRFbWl0dGVyTW9jayk7XG5yZXR1cm4gbW9jaztcbn07XG5cbnZhciBkZWZhdWx0R2V0VmVyc2lvbj1mdW5jdGlvbiBkZWZhdWx0R2V0VmVyc2lvbihtb2R1bGUpe3JldHVybiBtb2R1bGUuVkVSU0lPTjt9O1xuXG5cbnZhciBjcmVhdGU9ZnVuY3Rpb24gU2FmZU1vZHVsZUNyZWF0ZShvcHRpb25zKXtcbmlmKCFvcHRpb25zKXtcbnRocm93IG5ldyBFcnJvcigoMCxfZGVkZW50Mi5kZWZhdWx0KShfdGVtcGxhdGVPYmplY3QpKTtcblxuXG59dmFyXG5cbm1vZHVsZU5hbWU9XG5cblxuXG5vcHRpb25zLm1vZHVsZU5hbWU7dmFyIG1vY2s9b3B0aW9ucy5tb2NrO3ZhciBpc0V2ZW50RW1pdHRlcj1vcHRpb25zLmlzRXZlbnRFbWl0dGVyO3ZhciB2ZXJzaW9uT3ZlcnJpZGVzPW9wdGlvbnMudmVyc2lvbk92ZXJyaWRlczt2YXJcblxuZ2V0VmVyc2lvbj1cbm9wdGlvbnMuZ2V0VmVyc2lvbjtcblxuaWYoIWdldFZlcnNpb24pe1xuZ2V0VmVyc2lvbj1kZWZhdWx0R2V0VmVyc2lvbjtcbn1cblxuaWYoIW1vZHVsZU5hbWUpe1xudGhyb3cgbmV3IEVycm9yKCgwLF9kZWRlbnQyLmRlZmF1bHQpKF90ZW1wbGF0ZU9iamVjdDIpKTtcblxuXG59XG52YXIgTU9EVUxFX05BTUU9Z2V0UHJpbWFyeU5hbWUobW9kdWxlTmFtZSk7XG5cbmlmKCFtb2NrKXtcbnRocm93IG5ldyBFcnJvcigoMCxfZGVkZW50Mi5kZWZhdWx0KShfdGVtcGxhdGVPYmplY3QzKSk7XG5cblxufVxuXG52YXIgcmVzdWx0PXt9O1xuXG52YXIgbW9kdWxlPWdldE1vZHVsZShtb2R1bGVOYW1lLG1vY2ssaXNFdmVudEVtaXR0ZXIpO1xudmFyIHZlcnNpb249Z2V0VmVyc2lvbihtb2R1bGUpO1xuXG5pZihfX0RFVl9fKXtcbk9iamVjdC5rZXlzKG1vZHVsZSkuZm9yRWFjaChmdW5jdGlvbihrZXkpe1xuaWYoIWhhc093blByb3BlcnR5LmNhbGwobW9jayxrZXkpJiYhVU5NT0NLRURfUFJPUEVSVFlfV0hJVEVMSVNUW2tleV0pe1xuY29uc29sZS53YXJuKCgwLF9kZWRlbnQyLmRlZmF1bHQpKF90ZW1wbGF0ZU9iamVjdDQsXG5NT0RVTEVfTkFNRSxrZXkpKTtcblxuXG59XG59KTtcbn1cblxuaWYoaXNFdmVudEVtaXR0ZXIpe1xuLy8gVE9ETyhsbXIpOiBzaG91bGQgdGhpcyBiZSBwdXQgaW5zaWRlIG9mIGEgdHJ5L2NhdGNoP1xucmVzdWx0LmVtaXR0ZXI9bmV3IF9yZWFjdE5hdGl2ZS5OYXRpdmVFdmVudEVtaXR0ZXIobW9kdWxlKTtcbn1cblxudmFyIG92ZXJyaWRlcz12b2lkIDA7XG52YXIgYm91bmRPdmVycmlkZXM9dm9pZCAwO1xuaWYodmVyc2lvbk92ZXJyaWRlcyl7XG5vdmVycmlkZXM9dmVyc2lvbk92ZXJyaWRlc1t2ZXJzaW9uXTtcbmJvdW5kT3ZlcnJpZGVzPXt9O1xuaWYob3ZlcnJpZGVzKXtcbk9iamVjdC5rZXlzKG92ZXJyaWRlcykuZm9yRWFjaChmdW5jdGlvbihrZXkpe1xuaWYodHlwZW9mIG92ZXJyaWRlc1trZXldPT09J2Z1bmN0aW9uJyl7XG5ib3VuZE92ZXJyaWRlc1trZXldPW92ZXJyaWRlc1trZXldKG1vZHVsZVtrZXldLG1vZHVsZSk7XG59ZWxzZXtcbmJvdW5kT3ZlcnJpZGVzW2tleV09b3ZlcnJpZGVzW2tleV07XG59XG59KTtcbn1cbn1cblxuX2V4dGVuZHMoXG5yZXN1bHQsXG5tb2NrLFxubW9kdWxlLFxuYm91bmRPdmVycmlkZXMpO1xuXG5cbnJldHVybiByZXN1bHQ7XG59O1xuXG5tb2R1bGUuZXhwb3J0cz1jcmVhdGU7Il19