{"version":3,"sources":["shallowRenderer.js"],"names":["checkPropTypes","require","React","emptyObject","invariant","ShallowRenderer","_context","_element","_instance","_newState","_rendered","_rendering","_forcedUpdate","_updater","Updater","element","context","_updateClassComponent","props","shouldConstruct","type","hasOwnProperty","currentlyValidatingElement","_mountClassComponent","render","getRenderOutput","componentWillUnmount","state","updater","componentWillMount","beforeState","oldProps","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","createRenderer","renderer","_renderer","publicInstance","callback","callerName","call","completeState","partialState","currentState","Component","prototype","isReactComponent"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @providesModule ReactShallowRendererEntry\n * @preventMunge\n */\n\n\nconst checkPropTypes = require('prop-types/checkPropTypes');\nconst React = require('react');\n\nconst emptyObject = require('fbjs/lib/emptyObject');\nconst invariant = require('fbjs/lib/invariant');\n\nclass ShallowRenderer {\n  static createRenderer = function () {\n    return new ShallowRenderer();\n  };\n\n  constructor() {\n    this._context = null;\n    this._element = null;\n    this._instance = null;\n    this._newState = null;\n    this._rendered = null;\n    this._rendering = false;\n    this._forcedUpdate = false;\n    this._updater = new Updater(this);\n  }\n\n  getMountedInstance() {\n    return this._instance;\n  }\n\n  getRenderOutput() {\n    return this._rendered;\n  }\n\n  render(element, context = emptyObject) {\n    if (this._rendering) {\n      return;\n    }\n\n    this._rendering = true;\n    this._element = element;\n    this._context = context;\n\n    if (this._instance) {\n      this._updateClassComponent(element.props, context);\n    } else if (shouldConstruct(element.type)) {\n      this._instance = new element.type(\n        element.props,\n        context,\n        this._updater,\n      );\n\n      if (element.type.hasOwnProperty('contextTypes')) {\n        currentlyValidatingElement = element;\n        currentlyValidatingElement = null;\n      }\n      this._mountClassComponent(element.props, context);\n    } else if (typeof element.type === 'function') {\n      this._rendered = element.type(element.props, context);\n    } else {\n      this._rendered = element.type.render(element.props, context);\n    }\n\n    this._rendering = false;\n\n    return this.getRenderOutput();\n  }\n\n  unmount() {\n    if (this._instance) {\n      if (typeof this._instance.componentWillUnmount === 'function') {\n        this._instance.componentWillUnmount();\n      }\n    }\n\n    this._context = null;\n    this._element = null;\n    this._newState = null;\n    this._rendered = null;\n    this._instance = null;\n  }\n\n  _mountClassComponent(props, context) {\n    this._instance.context = context;\n    this._instance.props = props;\n    this._instance.state = this._instance.state || emptyObject;\n    this._instance.updater = this._updater;\n\n    if (typeof this._instance.componentWillMount === 'function') {\n      const beforeState = this._newState;\n\n      this._instance.componentWillMount();\n\n      // setState may have been called during cWM\n      if (beforeState !== this._newState) {\n        this._instance.state = this._newState || emptyObject;\n      }\n    }\n\n    this._rendered = this._instance.render();\n    // Intentionally do not call componentDidMount()\n    // because DOM refs are not available.\n  }\n\n  _updateClassComponent(props, context) {\n    const oldProps = this._instance.props;\n\n    if (\n      oldProps !== props\n      && typeof this._instance.componentWillReceiveProps === 'function'\n    ) {\n      this._instance.componentWillReceiveProps(props, context);\n    }\n\n    // Read state after cWRP in case it calls setState\n    // Fallback to previous instance state to support rendering React.cloneElement()\n    const state = this._newState || this._instance.state || emptyObject;\n\n    if (typeof this._instance.shouldComponentUpdate === 'function') {\n      if (\n        this._forcedUpdate\n        || this._instance.shouldComponentUpdate(props, state, context) === false\n      ) {\n        this._instance.context = context;\n        this._instance.props = props;\n        this._instance.state = state;\n        this._forcedUpdate = false;\n\n        return;\n      }\n    }\n\n    if (typeof this._instance.componentWillUpdate === 'function') {\n      this._instance.componentWillUpdate(props, state, context);\n    }\n\n    this._instance.context = context;\n    this._instance.props = props;\n    this._instance.state = state;\n\n    this._rendered = this._instance.render();\n    // Intentionally do not call componentDidUpdate()\n    // because DOM refs are not available.\n  }\n}\n\nclass Updater {\n  constructor(renderer) {\n    this._renderer = renderer;\n  }\n\n  isMounted(publicInstance) {\n    return !!this._renderer._element;\n  }\n\n  enqueueForceUpdate(publicInstance, callback, callerName) {\n    this._renderer._forcedUpdate = true;\n    this._renderer.render(this._renderer._element, this._renderer._context);\n\n    if (typeof callback === 'function') {\n      callback.call(publicInstance);\n    }\n  }\n\n  enqueueReplaceState(publicInstance, completeState, callback, callerName) {\n    this._renderer._newState = completeState;\n    this._renderer.render(this._renderer._element, this._renderer._context);\n\n    if (typeof callback === 'function') {\n      callback.call(publicInstance);\n    }\n  }\n\n  enqueueSetState(publicInstance, partialState, callback, callerName) {\n    const currentState = this._renderer._newState || publicInstance.state;\n\n    if (typeof partialState === 'function') {\n      partialState = partialState(currentState, publicInstance.props);\n    }\n\n    this._renderer._newState = {\n      ...currentState,\n      ...partialState,\n    };\n\n    this._renderer.render(this._renderer._element, this._renderer._context);\n\n    if (typeof callback === 'function') {\n      callback.call(publicInstance);\n    }\n  }\n}\n\nvar currentlyValidatingElement = null;\n\nfunction shouldConstruct(Component) {\n  return !!(Component.prototype && Component.prototype.isReactComponent);\n}\n\nexport default ShallowRenderer;\n"]}