b06707f6408c97ef455cf425dd7105ed
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _reactNative = require("react-native");

var _getSceneIndicesForInterpolationInputRange = _interopRequireDefault(require("../../utils/getSceneIndicesForInterpolationInputRange"));

function hasHeader(scene) {
  if (!scene) {
    return true;
  }

  var descriptor = scene.descriptor;
  return descriptor.options.header !== null;
}

var crossFadeInterpolation = function crossFadeInterpolation(scenes, first, index, last) {
  return {
    inputRange: [first, first + 0.001, index - 0.9, index - 0.2, index, last - 0.001, last],
    outputRange: [0, hasHeader(scenes[first]) ? 0 : 1, hasHeader(scenes[first]) ? 0 : 1, hasHeader(scenes[first]) ? 0.3 : 1, hasHeader(scenes[index]) ? 1 : 0, hasHeader(scenes[last]) ? 0 : 1, 0],
    extrapolate: 'clamp'
  };
};

function isGoingBack(scenes) {
  var lastSceneIndexInScenes = scenes.length - 1;
  return !scenes[lastSceneIndexInScenes].isActive;
}

function forLayout(props) {
  var layout = props.layout,
      position = props.position,
      scene = props.scene,
      scenes = props.scenes,
      mode = props.mode;

  if (mode !== 'float') {
    return {};
  }

  var isBack = isGoingBack(scenes);
  var interpolate = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!interpolate) return {};
  var first = interpolate.first,
      last = interpolate.last;
  var index = scene.index;

  var width = layout.initWidth || _reactNative.Dimensions.get('window').width;

  if (isBack && !hasHeader(scenes[index]) && !hasHeader(scenes[last]) || !isBack && !hasHeader(scenes[first]) && !hasHeader(scenes[index])) {
    return {
      transform: [{
        translateX: width
      }]
    };
  }

  var rtlMult = _reactNative.I18nManager.isRTL ? -1 : 1;
  var translateX = position.interpolate({
    inputRange: [first, index, last],
    outputRange: [rtlMult * (hasHeader(scenes[first]) ? 0 : width), rtlMult * (hasHeader(scenes[index]) ? 0 : isBack ? width : -width), rtlMult * (hasHeader(scenes[last]) ? 0 : -width)],
    extrapolate: 'clamp'
  });
  return {
    transform: [{
      translateX: translateX
    }]
  };
}

function forLeft(props) {
  var position = props.position,
      scene = props.scene,
      scenes = props.scenes;
  var interpolate = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!interpolate) return {
    opacity: 0
  };
  var first = interpolate.first,
      last = interpolate.last;
  var index = scene.index;
  return {
    opacity: position.interpolate(crossFadeInterpolation(scenes, first, index, last))
  };
}

function forCenter(props) {
  var position = props.position,
      scene = props.scene,
      scenes = props.scenes;
  var interpolate = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!interpolate) return {
    opacity: 0
  };
  var first = interpolate.first,
      last = interpolate.last;
  var index = scene.index;
  return {
    opacity: position.interpolate(crossFadeInterpolation(scenes, first, index, last))
  };
}

function forRight(props) {
  var position = props.position,
      scene = props.scene,
      scenes = props.scenes;
  var interpolate = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!interpolate) return {
    opacity: 0
  };
  var first = interpolate.first,
      last = interpolate.last;
  var index = scene.index;
  return {
    opacity: position.interpolate(crossFadeInterpolation(scenes, first, index, last))
  };
}

function forLeftButton(props) {
  var position = props.position,
      scene = props.scene,
      scenes = props.scenes;
  var interpolate = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!interpolate) return {
    opacity: 0
  };
  var first = interpolate.first,
      last = interpolate.last;
  var index = scene.index;
  var inputRange = [first, first + 0.001, first + Math.abs(index - first) / 2, index, last - Math.abs(last - index) / 2, last - 0.001, last];
  var outputRange = [0, hasHeader(scenes[first]) ? 0 : 1, hasHeader(scenes[first]) ? 0.3 : 1, hasHeader(scenes[index]) ? 1 : 0, hasHeader(scenes[last]) ? 0.3 : 1, hasHeader(scenes[last]) ? 0 : 1, 0];
  return {
    opacity: position.interpolate({
      inputRange: inputRange,
      outputRange: outputRange,
      extrapolate: 'clamp'
    })
  };
}

var LEFT_LABEL_OFFSET = _reactNative.Dimensions.get('window').width / 2 - 70 - 25;

function forLeftLabel(props) {
  var position = props.position,
      scene = props.scene,
      scenes = props.scenes;
  var interpolate = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!interpolate) return {
    opacity: 0
  };
  var first = interpolate.first,
      last = interpolate.last;
  var index = scene.index;
  var offset = LEFT_LABEL_OFFSET;
  return {
    opacity: position.interpolate({
      inputRange: [first, first + 0.001, index - 0.35, index, index + 0.5, last - 0.001, last],
      outputRange: [0, hasHeader(scenes[first]) ? 0 : 1, hasHeader(scenes[first]) ? 0 : 1, hasHeader(scenes[index]) ? 1 : 0, hasHeader(scenes[last]) ? 0.5 : 1, hasHeader(scenes[last]) ? 0 : 1, 0],
      extrapolate: 'clamp'
    }),
    transform: [{
      translateX: position.interpolate({
        inputRange: [first, first + 0.001, index, last - 0.001, last],
        outputRange: _reactNative.I18nManager.isRTL ? [-offset * 1.5, hasHeader(scenes[first]) ? -offset * 1.5 : 0, 0, hasHeader(scenes[last]) ? offset : 0, offset] : [offset, hasHeader(scenes[first]) ? offset : 0, 0, hasHeader(scenes[last]) ? -offset * 1.5 : 0, -offset * 1.5],
        extrapolate: 'clamp'
      })
    }]
  };
}

var TITLE_OFFSET_IOS = _reactNative.Dimensions.get('window').width / 2 - 70 + 25;

function forCenterFromLeft(props) {
  var position = props.position,
      scene = props.scene,
      scenes = props.scenes;
  var interpolate = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!interpolate) return {
    opacity: 0
  };
  var first = interpolate.first,
      last = interpolate.last;
  var index = scene.index;
  var offset = TITLE_OFFSET_IOS;
  return {
    opacity: position.interpolate({
      inputRange: [first, first + 0.001, index - 0.5, index, index + 0.7, last - 0.001, last],
      outputRange: [0, hasHeader(scenes[first]) ? 0 : 1, hasHeader(scenes[first]) ? 0 : 1, hasHeader(scenes[index]) ? 1 : 0, hasHeader(scenes[last]) ? 0 : 1, hasHeader(scenes[last]) ? 0 : 1, 0],
      extrapolate: 'clamp'
    }),
    transform: [{
      translateX: position.interpolate({
        inputRange: [first, first + 0.001, index, last - 0.001, last],
        outputRange: _reactNative.I18nManager.isRTL ? [-offset, hasHeader(scenes[first]) ? -offset : 0, 0, hasHeader(scenes[last]) ? offset : 0, offset] : [offset, hasHeader(scenes[first]) ? offset : 0, 0, hasHeader(scenes[last]) ? -offset : 0, -offset],
        extrapolate: 'clamp'
      })
    }]
  };
}

function forBackgroundWithFade(props) {
  var position = props.position,
      scene = props.scene;
  var sceneRange = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!sceneRange) return {
    opacity: 0
  };
  return {
    opacity: position.interpolate({
      inputRange: [sceneRange.first, scene.index, sceneRange.last],
      outputRange: [0, 1, 0],
      extrapolate: 'clamp'
    })
  };
}

var VISIBLE = {
  opacity: 1
};
var HIDDEN = {
  opacity: 0
};

function forBackgroundWithInactiveHidden(_ref) {
  var navigation = _ref.navigation,
      scene = _ref.scene;
  return navigation.state.index === scene.index ? VISIBLE : HIDDEN;
}

var BACKGROUND_OFFSET = _reactNative.Dimensions.get('window').width;

function forBackgroundWithTranslation(props) {
  var position = props.position,
      scene = props.scene;
  var interpolate = (0, _getSceneIndicesForInterpolationInputRange.default)(props);
  if (!interpolate) return {
    opacity: 0
  };
  var first = interpolate.first,
      last = interpolate.last;
  var index = scene.index;
  var offset = BACKGROUND_OFFSET;
  var outputRange = [offset, 0, -offset];
  return {
    transform: [{
      translateX: position.interpolate({
        inputRange: [first, index, last],
        outputRange: _reactNative.I18nManager.isRTL ? outputRange.reverse() : outputRange,
        extrapolate: 'clamp'
      })
    }]
  };
}

var forBackground = forBackgroundWithInactiveHidden;
var _default = {
  forLayout: forLayout,
  forLeft: forLeft,
  forLeftButton: forLeftButton,
  forLeftLabel: forLeftLabel,
  forCenterFromLeft: forCenterFromLeft,
  forCenter: forCenter,
  forRight: forRight,
  forBackground: forBackground,
  forBackgroundWithInactiveHidden: forBackgroundWithInactiveHidden,
  forBackgroundWithFade: forBackgroundWithFade,
  forBackgroundWithTranslation: forBackgroundWithTranslation
};
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkhlYWRlclN0eWxlSW50ZXJwb2xhdG9yLnRzeCJdLCJuYW1lcyI6WyJkZXNjcmlwdG9yIiwic2NlbmUiLCJjcm9zc0ZhZGVJbnRlcnBvbGF0aW9uIiwiaW5wdXRSYW5nZSIsImZpcnN0IiwiaW5kZXgiLCJsYXN0Iiwib3V0cHV0UmFuZ2UiLCJoYXNIZWFkZXIiLCJzY2VuZXMiLCJleHRyYXBvbGF0ZSIsImxhc3RTY2VuZUluZGV4SW5TY2VuZXMiLCJsYXlvdXQiLCJwb3NpdGlvbiIsIm1vZGUiLCJwcm9wcyIsImlzQmFjayIsImlzR29pbmdCYWNrIiwiaW50ZXJwb2xhdGUiLCJ3aWR0aCIsIkRpbWVuc2lvbnMiLCJ0cmFuc2Zvcm0iLCJ0cmFuc2xhdGVYIiwicnRsTXVsdCIsIkkxOG5NYW5hZ2VyIiwib3BhY2l0eSIsIk1hdGgiLCJMRUZUX0xBQkVMX09GRlNFVCIsIm9mZnNldCIsIlRJVExFX09GRlNFVF9JT1MiLCJzY2VuZVJhbmdlIiwiVklTSUJMRSIsIkhJRERFTiIsIm5hdmlnYXRpb24iLCJCQUNLR1JPVU5EX09GRlNFVCIsImZvckJhY2tncm91bmQiLCJmb3JMYXlvdXQiLCJmb3JMZWZ0IiwiZm9yTGVmdEJ1dHRvbiIsImZvckxlZnRMYWJlbCIsImZvckNlbnRlckZyb21MZWZ0IiwiZm9yQ2VudGVyIiwiZm9yUmlnaHQiLCJmb3JCYWNrZ3JvdW5kV2l0aEluYWN0aXZlSGlkZGVuIiwiZm9yQmFja2dyb3VuZFdpdGhGYWRlIiwiZm9yQmFja2dyb3VuZFdpdGhUcmFuc2xhdGlvbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLElBQUEsWUFBQSxHQUFBLE9BQUEsQ0FBQSxjQUFBLENBQUE7O0FBQ0EsSUFBQSwwQ0FBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLHVEQUFBLENBQUEsQ0FBQTs7QUFHQSxTQUFBLFNBQUEsQ0FBQSxLQUFBLEVBQWlDO0FBQy9CLE1BQUksQ0FBSixLQUFBLEVBQVk7QUFDVixXQUFBLElBQUE7QUFGNkI7O0FBQUEsTUFJ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c0IsYUFBYSxHQUFuQiwrQkFBQTtlQUVlO0FBQ2JDLEVBQUFBLFNBQVMsRUFESSxTQUFBO0FBRWJDLEVBQUFBLE9BQU8sRUFGTSxPQUFBO0FBR2JDLEVBQUFBLGFBQWEsRUFIQSxhQUFBO0FBSWJDLEVBQUFBLFlBQVksRUFKQyxZQUFBO0FBS2JDLEVBQUFBLGlCQUFpQixFQUxKLGlCQUFBO0FBTWJDLEVBQUFBLFNBQVMsRUFOSSxTQUFBO0FBT2JDLEVBQUFBLFFBQVEsRUFQSyxRQUFBO0FBUWJQLEVBQUFBLGFBQWEsRUFSQSxhQUFBO0FBU2JRLEVBQUFBLCtCQUErQixFQVRsQiwrQkFBQTtBQVViQyxFQUFBQSxxQkFBcUIsRUFWUixxQkFBQTtBQVdiQyxFQUFBQSw0QkFBNEIsRUFYZjtBQUFBLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaW1lbnNpb25zLCBJMThuTWFuYWdlciB9IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG5pbXBvcnQgZ2V0U2NlbmVJbmRpY2VzRm9ySW50ZXJwb2xhdGlvbklucHV0UmFuZ2UgZnJvbSAnLi4vLi4vdXRpbHMvZ2V0U2NlbmVJbmRpY2VzRm9ySW50ZXJwb2xhdGlvbklucHV0UmFuZ2UnO1xuaW1wb3J0IHsgU2NlbmUsIFNjZW5lSW50ZXJwb2xhdG9yUHJvcHMgfSBmcm9tICcuLi8uLi90eXBlcyc7XG5cbmZ1bmN0aW9uIGhhc0hlYWRlcihzY2VuZTogU2NlbmUpIHtcbiAgaWYgKCFzY2VuZSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGNvbnN0IHsgZGVzY3JpcHRvciB9ID0gc2NlbmU7XG4gIHJldHVybiBkZXNjcmlwdG9yLm9wdGlvbnMuaGVhZGVyICE9PSBudWxsO1xufVxuXG5jb25zdCBjcm9zc0ZhZGVJbnRlcnBvbGF0aW9uID0gKFxuICBzY2VuZXM6IFNjZW5lW10sXG4gIGZpcnN0OiBudW1iZXIsXG4gIGluZGV4OiBudW1iZXIsXG4gIGxhc3Q6IG51bWJlclxuKTogeyBpbnB1dFJhbmdlOiBudW1iZXJbXTsgb3V0cHV0UmFuZ2U6IG51bWJlcltdOyBleHRyYXBvbGF0ZTogJ2NsYW1wJyB9ID0+ICh7XG4gIGlucHV0UmFuZ2U6IFtcbiAgICBmaXJzdCxcbiAgICBmaXJzdCArIDAuMDAxLFxuICAgIGluZGV4IC0gMC45LFxuICAgIGluZGV4IC0gMC4yLFxuICAgIGluZGV4LFxuICAgIGxhc3QgLSAwLjAwMSxcbiAgICBsYXN0LFxuICBdLFxuICBvdXRwdXRSYW5nZTogW1xuICAgIDAsXG4gICAgaGFzSGVhZGVyKHNjZW5lc1tmaXJzdF0pID8gMCA6IDEsXG4gICAgaGFzSGVhZGVyKHNjZW5lc1tmaXJzdF0pID8gMCA6IDEsXG4gICAgaGFzSGVhZGVyKHNjZW5lc1tmaXJzdF0pID8gMC4zIDogMSxcbiAgICBoYXNIZWFkZXIoc2NlbmVzW2luZGV4XSkgPyAxIDogMCxcbiAgICBoYXNIZWFkZXIoc2NlbmVzW2xhc3RdKSA/IDAgOiAxLFxuICAgIDAsXG4gIF0sXG4gIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxufSk7XG5cbi8qKlxuICogVXRpbGl0aWVzIHRoYXQgYnVpbGQgdGhlIHN0eWxlIGZvciB0aGUgbmF2aWdhdGlvbiBoZWFkZXIuXG4gKlxuICogKy0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tK1xuICogfCAgICAgICAgICAgICB8ICAgICAgICAgICAgIHwgICAgICAgICAgICAgfFxuICogfCAgICBMZWZ0ICAgICB8ICAgVGl0bGUgICAgIHwgICBSaWdodCAgICAgfFxuICogfCAgQ29tcG9uZW50ICB8ICBDb21wb25lbnQgIHwgQ29tcG9uZW50ICAgfFxuICogfCAgICAgICAgICAgICB8ICAgICAgICAgICAgIHwgICAgICAgICAgICAgfFxuICogKy0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLS0tK1xuICovXG5cbmZ1bmN0aW9uIGlzR29pbmdCYWNrKHNjZW5lczogU2NlbmVbXSkge1xuICBjb25zdCBsYXN0U2NlbmVJbmRleEluU2NlbmVzID0gc2NlbmVzLmxlbmd0aCAtIDE7XG4gIHJldHVybiAhc2NlbmVzW2xhc3RTY2VuZUluZGV4SW5TY2VuZXNdLmlzQWN0aXZlO1xufVxuXG5mdW5jdGlvbiBmb3JMYXlvdXQocHJvcHM6IFNjZW5lSW50ZXJwb2xhdG9yUHJvcHMpIHtcbiAgY29uc3QgeyBsYXlvdXQsIHBvc2l0aW9uLCBzY2VuZSwgc2NlbmVzLCBtb2RlIH0gPSBwcm9wcztcbiAgaWYgKG1vZGUgIT09ICdmbG9hdCcpIHtcbiAgICByZXR1cm4ge307XG4gIH1cbiAgY29uc3QgaXNCYWNrID0gaXNHb2luZ0JhY2soc2NlbmVzKTtcblxuICBjb25zdCBpbnRlcnBvbGF0ZSA9IGdldFNjZW5lSW5kaWNlc0ZvckludGVycG9sYXRpb25JbnB1dFJhbmdlKHByb3BzKTtcbiAgaWYgKCFpbnRlcnBvbGF0ZSkgcmV0dXJuIHt9O1xuXG4gIGNvbnN0IHsgZmlyc3QsIGxhc3QgfSA9IGludGVycG9sYXRlO1xuICBjb25zdCBpbmRleCA9IHNjZW5lLmluZGV4O1xuXG4gIC8vIFdlIHJlYWxseSBzaG91bGRuJ3QgcmVuZGVyIHRoZSBzY2VuZSBhdCBhbGwgdW50aWwgd2Uga25vdyB0aGUgd2lkdGggb2YgdGhlXG4gIC8vIHN0YWNrLiBUaGF0IHNhaWQsIGluIGV2ZXJ5IGNhc2UgdGhhdCBJIGhhdmUgZXZlciBzZWVuLCB0aGlzIGhhcyBqdXN0IGJlZW5cbiAgLy8gdGhlIGZ1bGwgd2lkdGggb2YgdGhlIHdpbmRvdy4gVGhpcyB3b24ndCBjb250aW51ZSB0byBiZSB0cnVlIGlmIHdlIHN1cHBvcnRcbiAgLy8gbGF5b3V0cyBsaWtlIGlQYWQgbWFzdGVyLWRldGFpbC4gRm9yIG5vdywgaW4gb3JkZXIgdG8gc29sdmVcbiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlYWN0LW5hdmlnYXRpb24vcmVhY3QtbmF2aWdhdGlvbi9pc3N1ZXMvNDI2NCwgSSBoYXZlXG4gIC8vIG9wdGVkIGZvciB0aGUgaGV1cmlzdGljIHRoYXQgd2Ugd2lsbCB1c2UgdGhlIHdpbmRvdyB3aWR0aCB1bnRpbCB3ZSBoYXZlXG4gIC8vIG1lYXN1cmVkIChhbmQgdGhleSB3aWxsIHVzdWFsbHkgYmUgdGhlIHNhbWUpLlxuICBjb25zdCB3aWR0aCA9IGxheW91dC5pbml0V2lkdGggfHwgRGltZW5zaW9ucy5nZXQoJ3dpbmRvdycpLndpZHRoO1xuXG4gIC8vIE1ha2Ugc3VyZSB0aGUgaGVhZGVyIHN0YXlzIGhpZGRlbiB3aGVuIHRyYW5zaXRpb25pbmcgYmV0d2VlbiAyIHNjcmVlbnNcbiAgLy8gd2l0aCBubyBoZWFkZXIuXG4gIGlmIChcbiAgICAoaXNCYWNrICYmICFoYXNIZWFkZXIoc2NlbmVzW2luZGV4XSkgJiYgIWhhc0hlYWRlcihzY2VuZXNbbGFzdF0pKSB8fFxuICAgICghaXNCYWNrICYmICFoYXNIZWFkZXIoc2NlbmVzW2ZpcnN0XSkgJiYgIWhhc0hlYWRlcihzY2VuZXNbaW5kZXhdKSlcbiAgKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRyYW5zZm9ybTogW3sgdHJhbnNsYXRlWDogd2lkdGggfV0sXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IHJ0bE11bHQgPSBJMThuTWFuYWdlci5pc1JUTCA/IC0xIDogMTtcbiAgY29uc3QgdHJhbnNsYXRlWCA9IHBvc2l0aW9uLmludGVycG9sYXRlKHtcbiAgICBpbnB1dFJhbmdlOiBbZmlyc3QsIGluZGV4LCBsYXN0XSxcbiAgICBvdXRwdXRSYW5nZTogW1xuICAgICAgcnRsTXVsdCAqIChoYXNIZWFkZXIoc2NlbmVzW2ZpcnN0XSkgPyAwIDogd2lkdGgpLFxuICAgICAgcnRsTXVsdCAqIChoYXNIZWFkZXIoc2NlbmVzW2luZGV4XSkgPyAwIDogaXNCYWNrID8gd2lkdGggOiAtd2lkdGgpLFxuICAgICAgcnRsTXVsdCAqIChoYXNIZWFkZXIoc2NlbmVzW2xhc3RdKSA/IDAgOiAtd2lkdGgpLFxuICAgIF0sXG4gICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgdHJhbnNmb3JtOiBbeyB0cmFuc2xhdGVYIH1dLFxuICB9O1xufVxuXG5mdW5jdGlvbiBmb3JMZWZ0KHByb3BzOiBTY2VuZUludGVycG9sYXRvclByb3BzKSB7XG4gIGNvbnN0IHsgcG9zaXRpb24sIHNjZW5lLCBzY2VuZXMgfSA9IHByb3BzO1xuICBjb25zdCBpbnRlcnBvbGF0ZSA9IGdldFNjZW5lSW5kaWNlc0ZvckludGVycG9sYXRpb25JbnB1dFJhbmdlKHByb3BzKTtcblxuICBpZiAoIWludGVycG9sYXRlKSByZXR1cm4geyBvcGFjaXR5OiAwIH07XG5cbiAgY29uc3QgeyBmaXJzdCwgbGFzdCB9ID0gaW50ZXJwb2xhdGU7XG4gIGNvbnN0IGluZGV4ID0gc2NlbmUuaW5kZXg7XG5cbiAgcmV0dXJuIHtcbiAgICBvcGFjaXR5OiBwb3NpdGlvbi5pbnRlcnBvbGF0ZShcbiAgICAgIGNyb3NzRmFkZUludGVycG9sYXRpb24oc2NlbmVzLCBmaXJzdCwgaW5kZXgsIGxhc3QpXG4gICAgKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gZm9yQ2VudGVyKHByb3BzOiBTY2VuZUludGVycG9sYXRvclByb3BzKSB7XG4gIGNvbnN0IHsgcG9zaXRpb24sIHNjZW5lLCBzY2VuZXMgfSA9IHByb3BzO1xuICBjb25zdCBpbnRlcnBvbGF0ZSA9IGdldFNjZW5lSW5kaWNlc0ZvckludGVycG9sYXRpb25JbnB1dFJhbmdlKHByb3BzKTtcblxuICBpZiAoIWludGVycG9sYXRlKSByZXR1cm4geyBvcGFjaXR5OiAwIH07XG5cbiAgY29uc3QgeyBmaXJzdCwgbGFzdCB9ID0gaW50ZXJwb2xhdGU7XG4gIGNvbnN0IGluZGV4ID0gc2NlbmUuaW5kZXg7XG5cbiAgcmV0dXJuIHtcbiAgICBvcGFjaXR5OiBwb3NpdGlvbi5pbnRlcnBvbGF0ZShcbiAgICAgIGNyb3NzRmFkZUludGVycG9sYXRpb24oc2NlbmVzLCBmaXJzdCwgaW5kZXgsIGxhc3QpXG4gICAgKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gZm9yUmlnaHQocHJvcHM6IFNjZW5lSW50ZXJwb2xhdG9yUHJvcHMpIHtcbiAgY29uc3QgeyBwb3NpdGlvbiwgc2NlbmUsIHNjZW5lcyB9ID0gcHJvcHM7XG4gIGNvbnN0IGludGVycG9sYXRlID0gZ2V0U2NlbmVJbmRpY2VzRm9ySW50ZXJwb2xhdGlvbklucHV0UmFuZ2UocHJvcHMpO1xuXG4gIGlmICghaW50ZXJwb2xhdGUpIHJldHVybiB7IG9wYWNpdHk6IDAgfTtcbiAgY29uc3QgeyBmaXJzdCwgbGFzdCB9ID0gaW50ZXJwb2xhdGU7XG4gIGNvbnN0IGluZGV4ID0gc2NlbmUuaW5kZXg7XG5cbiAgcmV0dXJuIHtcbiAgICBvcGFjaXR5OiBwb3NpdGlvbi5pbnRlcnBvbGF0ZShcbiAgICAgIGNyb3NzRmFkZUludGVycG9sYXRpb24oc2NlbmVzLCBmaXJzdCwgaW5kZXgsIGxhc3QpXG4gICAgKSxcbiAgfTtcbn1cblxuLyoqXG4gKiBpT1MgVUlOYXZpZ2F0aW9uQ29udHJvbGxlciBzdHlsZSBpbnRlcnBvbGF0b3JzXG4gKi9cblxuZnVuY3Rpb24gZm9yTGVmdEJ1dHRvbihwcm9wczogU2NlbmVJbnRlcnBvbGF0b3JQcm9wcykge1xuICBjb25zdCB7IHBvc2l0aW9uLCBzY2VuZSwgc2NlbmVzIH0gPSBwcm9wcztcbiAgY29uc3QgaW50ZXJwb2xhdGUgPSBnZXRTY2VuZUluZGljZXNGb3JJbnRlcnBvbGF0aW9uSW5wdXRSYW5nZShwcm9wcyk7XG5cbiAgaWYgKCFpbnRlcnBvbGF0ZSkgcmV0dXJuIHsgb3BhY2l0eTogMCB9O1xuXG4gIGNvbnN0IHsgZmlyc3QsIGxhc3QgfSA9IGludGVycG9sYXRlO1xuICBjb25zdCBpbmRleCA9IHNjZW5lLmluZGV4O1xuXG4gIC8vIFRoZSBnaXN0IG9mIHdoYXQgd2UncmUgZG9pbmcgaGVyZSBpcyBhbmltYXRpbmcgdGhlIGxlZnQgYnV0dG9uIF9ub3JtYWxseV8gKGZhc3QgZmFkZSlcbiAgLy8gd2hlbiBib3RoIHNjZW5lcyBpbiB0cmFuc2l0aW9uIGhhdmUgaGVhZGVycy4gV2hlbiB0aGUgY3VycmVudCwgbmV4dCwgb3IgcHJldmlvdXMgc2NlbmUgX2Rvbid0X1xuICAvLyBoYXZlIGEgaGVhZGVyLCB3ZSBkb24ndCBmYWRlIHRoZSBidXR0b24sIGFuZCBvbmx5IHNldCBpdCdzIG9wYWNpdHkgdG8gMCBhdCB0aGUgbGFzdCBtb21lbnRcbiAgLy8gb2YgdGhlIHRyYW5zaXRpb24uXG4gIGNvbnN0IGlucHV0UmFuZ2UgPSBbXG4gICAgZmlyc3QsXG4gICAgZmlyc3QgKyAwLjAwMSxcbiAgICBmaXJzdCArIE1hdGguYWJzKGluZGV4IC0gZmlyc3QpIC8gMixcbiAgICBpbmRleCxcbiAgICBsYXN0IC0gTWF0aC5hYnMobGFzdCAtIGluZGV4KSAvIDIsXG4gICAgbGFzdCAtIDAuMDAxLFxuICAgIGxhc3QsXG4gIF07XG4gIGNvbnN0IG91dHB1dFJhbmdlID0gW1xuICAgIDAsXG4gICAgaGFzSGVhZGVyKHNjZW5lc1tmaXJzdF0pID8gMCA6IDEsXG4gICAgaGFzSGVhZGVyKHNjZW5lc1tmaXJzdF0pID8gMC4zIDogMSxcbiAgICBoYXNIZWFkZXIoc2NlbmVzW2luZGV4XSkgPyAxIDogMCxcbiAgICBoYXNIZWFkZXIoc2NlbmVzW2xhc3RdKSA/IDAuMyA6IDEsXG4gICAgaGFzSGVhZGVyKHNjZW5lc1tsYXN0XSkgPyAwIDogMSxcbiAgICAwLFxuICBdO1xuXG4gIHJldHVybiB7XG4gICAgb3BhY2l0eTogcG9zaXRpb24uaW50ZXJwb2xhdGUoe1xuICAgICAgaW5wdXRSYW5nZSxcbiAgICAgIG91dHB1dFJhbmdlLFxuICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgfSksXG4gIH07XG59XG5cbi8qXG4gKiBOT1RFOiB0aGlzIG9mZnNldCBjYWxjdWxhdGlvbiBpcyBhbiBhcHByb3hpbWF0aW9uIHRoYXQgZ2l2ZXMgdXNcbiAqIGRlY2VudCByZXN1bHRzIGluIG1hbnkgY2FzZXMsIGJ1dCBpdCBpcyB1bHRpbWF0ZWx5IGEgcG9vciBzdWJzdGl0dXRlXG4gKiBmb3IgdGV4dCBtZWFzdXJlbWVudC4gU2VlIHRoZSBjb21tZW50IG9uIHRpdGxlIGZvciBtb3JlIGluZm9ybWF0aW9uLlxuICpcbiAqIC0gNzAgaXMgdGhlIHdpZHRoIG9mIHRoZSBsZWZ0IGJ1dHRvbiBhcmVhLlxuICogLSAyNSBpcyB0aGUgd2lkdGggb2YgdGhlIGxlZnQgYnV0dG9uIGljb24gKHRvIGFjY291bnQgZm9yIGxhYmVsIG9mZnNldClcbiAqL1xuY29uc3QgTEVGVF9MQUJFTF9PRkZTRVQgPSBEaW1lbnNpb25zLmdldCgnd2luZG93Jykud2lkdGggLyAyIC0gNzAgLSAyNTtcblxuZnVuY3Rpb24gZm9yTGVmdExhYmVsKHByb3BzOiBTY2VuZUludGVycG9sYXRvclByb3BzKSB7XG4gIGNvbnN0IHsgcG9zaXRpb24sIHNjZW5lLCBzY2VuZXMgfSA9IHByb3BzO1xuICBjb25zdCBpbnRlcnBvbGF0ZSA9IGdldFNjZW5lSW5kaWNlc0ZvckludGVycG9sYXRpb25JbnB1dFJhbmdlKHByb3BzKTtcblxuICBpZiAoIWludGVycG9sYXRlKSByZXR1cm4geyBvcGFjaXR5OiAwIH07XG5cbiAgY29uc3QgeyBmaXJzdCwgbGFzdCB9ID0gaW50ZXJwb2xhdGU7XG4gIGNvbnN0IGluZGV4ID0gc2NlbmUuaW5kZXg7XG5cbiAgY29uc3Qgb2Zmc2V0ID0gTEVGVF9MQUJFTF9PRkZTRVQ7XG5cbiAgLy8gU2ltaWxhcmx5IHRvIHRoZSBhbmltYXRpb24gb2YgdGhlIGxlZnQgbGFiZWwsIHdoZW4gYW5pbWF0aW5nIHRvIG9yIGZyb20gYSBzY2VuZSB3aXRob3V0XG4gIC8vIGEgaGVhZGVyLCB3ZSBrZWVwIHRoZSBsYWJlbCBhdCBmdWxsIG9wYWNpdHkgYW5kIGluIHRoZSBzYW1lIHBvc2l0aW9uIGZvciBhcyBsb25nIGFzIHBvc3NpYmxlLlxuICByZXR1cm4ge1xuICAgIC8vIEZvciBub3cgd2UgZmFkZSBvdXQgdGhlIGxhYmVsIGJlZm9yZSBmYWRpbmcgaW4gdGhlIHRpdGxlLCBzbyB0aGVcbiAgICAvLyBkaWZmZXJlbmNlcyBiZXR3ZWVuIHRoZSBsYWJlbCBhbmQgdGl0bGUgcG9zaXRpb24gY2FuIGJlIGhvcGVmdWxseSBub3Qgc29cbiAgICAvLyBub3RpY2FibGUgdG8gdGhlIHVzZXJcbiAgICBvcGFjaXR5OiBwb3NpdGlvbi5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbXG4gICAgICAgIGZpcnN0LFxuICAgICAgICBmaXJzdCArIDAuMDAxLFxuICAgICAgICBpbmRleCAtIDAuMzUsXG4gICAgICAgIGluZGV4LFxuICAgICAgICBpbmRleCArIDAuNSxcbiAgICAgICAgbGFzdCAtIDAuMDAxLFxuICAgICAgICBsYXN0LFxuICAgICAgXSxcbiAgICAgIG91dHB1dFJhbmdlOiBbXG4gICAgICAgIDAsXG4gICAgICAgIGhhc0hlYWRlcihzY2VuZXNbZmlyc3RdKSA/IDAgOiAxLFxuICAgICAgICBoYXNIZWFkZXIoc2NlbmVzW2ZpcnN0XSkgPyAwIDogMSxcbiAgICAgICAgaGFzSGVhZGVyKHNjZW5lc1tpbmRleF0pID8gMSA6IDAsXG4gICAgICAgIGhhc0hlYWRlcihzY2VuZXNbbGFzdF0pID8gMC41IDogMSxcbiAgICAgICAgaGFzSGVhZGVyKHNjZW5lc1tsYXN0XSkgPyAwIDogMSxcbiAgICAgICAgMCxcbiAgICAgIF0sXG4gICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICB9KSxcbiAgICB0cmFuc2Zvcm06IFtcbiAgICAgIHtcbiAgICAgICAgdHJhbnNsYXRlWDogcG9zaXRpb24uaW50ZXJwb2xhdGUoe1xuICAgICAgICAgIGlucHV0UmFuZ2U6IFtmaXJzdCwgZmlyc3QgKyAwLjAwMSwgaW5kZXgsIGxhc3QgLSAwLjAwMSwgbGFzdF0sXG4gICAgICAgICAgb3V0cHV0UmFuZ2U6IEkxOG5NYW5hZ2VyLmlzUlRMXG4gICAgICAgICAgICA/IFtcbiAgICAgICAgICAgICAgICAtb2Zmc2V0ICogMS41LFxuICAgICAgICAgICAgICAgIGhhc0hlYWRlcihzY2VuZXNbZmlyc3RdKSA/IC1vZmZzZXQgKiAxLjUgOiAwLFxuICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgaGFzSGVhZGVyKHNjZW5lc1tsYXN0XSkgPyBvZmZzZXQgOiAwLFxuICAgICAgICAgICAgICAgIG9mZnNldCxcbiAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgOiBbXG4gICAgICAgICAgICAgICAgb2Zmc2V0LFxuICAgICAgICAgICAgICAgIGhhc0hlYWRlcihzY2VuZXNbZmlyc3RdKSA/IG9mZnNldCA6IDAsXG4gICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICBoYXNIZWFkZXIoc2NlbmVzW2xhc3RdKSA/IC1vZmZzZXQgKiAxLjUgOiAwLFxuICAgICAgICAgICAgICAgIC1vZmZzZXQgKiAxLjUsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgICAgIH0pLFxuICAgICAgfSxcbiAgICBdLFxuICB9O1xufVxuXG4vKlxuICogTk9URTogdGhpcyBvZmZzZXQgY2FsY3VsYXRpb24gaXMgYSBhbiBhcHByb3hpbWF0aW9uIHRoYXQgZ2l2ZXMgdXNcbiAqIGRlY2VudCByZXN1bHRzIGluIG1hbnkgY2FzZXMsIGJ1dCBpdCBpcyB1bHRpbWF0ZWx5IGEgcG9vciBzdWJzdGl0dXRlXG4gKiBmb3IgdGV4dCBtZWFzdXJlbWVudC4gV2Ugd2FudCB0aGUgYmFjayBidXR0b24gbGFiZWwgdG8gdHJhbnNpdGlvblxuICogc21vb3RobHkgaW50byB0aGUgdGl0bGUgdGV4dCBhbmQgdG8gZG8gdGhpcyB3ZSBuZWVkIHRvIHVuZGVyc3RhbmRcbiAqIHdoZXJlIHRoZSB0aXRsZSBpcyBwb3NpdGlvbmVkIHdpdGhpbiB0aGUgdGl0bGUgY29udGFpbmVyIChzaW5jZSBpdCBpc1xuICogY2VudGVyZWQpLlxuICpcbiAqIC0gNzAgaXMgdGhlIHdpZHRoIG9mIHRoZSBsZWZ0IGJ1dHRvbiBhcmVhLlxuICogLSAyNSBpcyB0aGUgd2lkdGggb2YgdGhlIGxlZnQgYnV0dG9uIGljb24gKHRvIGFjY291bnQgZm9yIGxhYmVsIG9mZnNldClcbiAqL1xuY29uc3QgVElUTEVfT0ZGU0VUX0lPUyA9IERpbWVuc2lvbnMuZ2V0KCd3aW5kb3cnKS53aWR0aCAvIDIgLSA3MCArIDI1O1xuXG5mdW5jdGlvbiBmb3JDZW50ZXJGcm9tTGVmdChwcm9wczogU2NlbmVJbnRlcnBvbGF0b3JQcm9wcykge1xuICBjb25zdCB7IHBvc2l0aW9uLCBzY2VuZSwgc2NlbmVzIH0gPSBwcm9wcztcbiAgY29uc3QgaW50ZXJwb2xhdGUgPSBnZXRTY2VuZUluZGljZXNGb3JJbnRlcnBvbGF0aW9uSW5wdXRSYW5nZShwcm9wcyk7XG5cbiAgaWYgKCFpbnRlcnBvbGF0ZSkgcmV0dXJuIHsgb3BhY2l0eTogMCB9O1xuXG4gIGNvbnN0IHsgZmlyc3QsIGxhc3QgfSA9IGludGVycG9sYXRlO1xuICBjb25zdCBpbmRleCA9IHNjZW5lLmluZGV4O1xuICBjb25zdCBvZmZzZXQgPSBUSVRMRV9PRkZTRVRfSU9TO1xuXG4gIHJldHVybiB7XG4gICAgb3BhY2l0eTogcG9zaXRpb24uaW50ZXJwb2xhdGUoe1xuICAgICAgaW5wdXRSYW5nZTogW1xuICAgICAgICBmaXJzdCxcbiAgICAgICAgZmlyc3QgKyAwLjAwMSxcbiAgICAgICAgaW5kZXggLSAwLjUsXG4gICAgICAgIGluZGV4LFxuICAgICAgICBpbmRleCArIDAuNyxcbiAgICAgICAgbGFzdCAtIDAuMDAxLFxuICAgICAgICBsYXN0LFxuICAgICAgXSxcbiAgICAgIG91dHB1dFJhbmdlOiBbXG4gICAgICAgIDAsXG4gICAgICAgIGhhc0hlYWRlcihzY2VuZXNbZmlyc3RdKSA/IDAgOiAxLFxuICAgICAgICBoYXNIZWFkZXIoc2NlbmVzW2ZpcnN0XSkgPyAwIDogMSxcbiAgICAgICAgaGFzSGVhZGVyKHNjZW5lc1tpbmRleF0pID8gMSA6IDAsXG4gICAgICAgIGhhc0hlYWRlcihzY2VuZXNbbGFzdF0pID8gMCA6IDEsXG4gICAgICAgIGhhc0hlYWRlcihzY2VuZXNbbGFzdF0pID8gMCA6IDEsXG4gICAgICAgIDAsXG4gICAgICBdLFxuICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgfSksXG4gICAgdHJhbnNmb3JtOiBbXG4gICAgICB7XG4gICAgICAgIHRyYW5zbGF0ZVg6IHBvc2l0aW9uLmludGVycG9sYXRlKHtcbiAgICAgICAgICBpbnB1dFJhbmdlOiBbZmlyc3QsIGZpcnN0ICsgMC4wMDEsIGluZGV4LCBsYXN0IC0gMC4wMDEsIGxhc3RdLFxuICAgICAgICAgIG91dHB1dFJhbmdlOiBJMThuTWFuYWdlci5pc1JUTFxuICAgICAgICAgICAgPyBbXG4gICAgICAgICAgICAgICAgLW9mZnNldCxcbiAgICAgICAgICAgICAgICBoYXNIZWFkZXIoc2NlbmVzW2ZpcnN0XSkgPyAtb2Zmc2V0IDogMCxcbiAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgIGhhc0hlYWRlcihzY2VuZXNbbGFzdF0pID8gb2Zmc2V0IDogMCxcbiAgICAgICAgICAgICAgICBvZmZzZXQsXG4gICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIDogW1xuICAgICAgICAgICAgICAgIG9mZnNldCxcbiAgICAgICAgICAgICAgICBoYXNIZWFkZXIoc2NlbmVzW2ZpcnN0XSkgPyBvZmZzZXQgOiAwLFxuICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgaGFzSGVhZGVyKHNjZW5lc1tsYXN0XSkgPyAtb2Zmc2V0IDogMCxcbiAgICAgICAgICAgICAgICAtb2Zmc2V0LFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICAgICAgICB9KSxcbiAgICAgIH0sXG4gICAgXSxcbiAgfTtcbn1cblxuLy8gRmFkZSBpbiBiYWNrZ3JvdW5kIG9mIGhlYWRlciB3aGlsZSB0cmFuc2l0aW9uaW5nXG5mdW5jdGlvbiBmb3JCYWNrZ3JvdW5kV2l0aEZhZGUocHJvcHM6IFNjZW5lSW50ZXJwb2xhdG9yUHJvcHMpIHtcbiAgY29uc3QgeyBwb3NpdGlvbiwgc2NlbmUgfSA9IHByb3BzO1xuICBjb25zdCBzY2VuZVJhbmdlID0gZ2V0U2NlbmVJbmRpY2VzRm9ySW50ZXJwb2xhdGlvbklucHV0UmFuZ2UocHJvcHMpO1xuICBpZiAoIXNjZW5lUmFuZ2UpIHJldHVybiB7IG9wYWNpdHk6IDAgfTtcbiAgcmV0dXJuIHtcbiAgICBvcGFjaXR5OiBwb3NpdGlvbi5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbc2NlbmVSYW5nZS5maXJzdCwgc2NlbmUuaW5kZXgsIHNjZW5lUmFuZ2UubGFzdF0sXG4gICAgICBvdXRwdXRSYW5nZTogWzAsIDEsIDBdLFxuICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgfSksXG4gIH07XG59XG5cbmNvbnN0IFZJU0lCTEUgPSB7IG9wYWNpdHk6IDEgfTtcbmNvbnN0IEhJRERFTiA9IHsgb3BhY2l0eTogMCB9O1xuXG4vLyBUb2dnbGUgdmlzaWJpbGl0eSBvZiBoZWFkZXIgd2l0aG91dCBmYWRpbmdcbmZ1bmN0aW9uIGZvckJhY2tncm91bmRXaXRoSW5hY3RpdmVIaWRkZW4oe1xuICBuYXZpZ2F0aW9uLFxuICBzY2VuZSxcbn06IFNjZW5lSW50ZXJwb2xhdG9yUHJvcHMpIHtcbiAgcmV0dXJuIG5hdmlnYXRpb24uc3RhdGUuaW5kZXggPT09IHNjZW5lLmluZGV4ID8gVklTSUJMRSA6IEhJRERFTjtcbn1cblxuLy8gVHJhbnNsYXRlIHRoZSBiYWNrZ3JvdW5kIHdpdGggdGhlIGNhcmRcbmNvbnN0IEJBQ0tHUk9VTkRfT0ZGU0VUID0gRGltZW5zaW9ucy5nZXQoJ3dpbmRvdycpLndpZHRoO1xuXG5mdW5jdGlvbiBmb3JCYWNrZ3JvdW5kV2l0aFRyYW5zbGF0aW9uKHByb3BzOiBTY2VuZUludGVycG9sYXRvclByb3BzKSB7XG4gIGNvbnN0IHsgcG9zaXRpb24sIHNjZW5lIH0gPSBwcm9wcztcbiAgY29uc3QgaW50ZXJwb2xhdGUgPSBnZXRTY2VuZUluZGljZXNGb3JJbnRlcnBvbGF0aW9uSW5wdXRSYW5nZShwcm9wcyk7XG4gIGlmICghaW50ZXJwb2xhdGUpIHJldHVybiB7IG9wYWNpdHk6IDAgfTtcbiAgY29uc3QgeyBmaXJzdCwgbGFzdCB9ID0gaW50ZXJwb2xhdGU7XG4gIGNvbnN0IGluZGV4ID0gc2NlbmUuaW5kZXg7XG4gIGNvbnN0IG9mZnNldCA9IEJBQ0tHUk9VTkRfT0ZGU0VUO1xuICBjb25zdCBvdXRwdXRSYW5nZSA9IFtvZmZzZXQsIDAsIC1vZmZzZXRdO1xuICByZXR1cm4ge1xuICAgIHRyYW5zZm9ybTogW1xuICAgICAge1xuICAgICAgICB0cmFuc2xhdGVYOiBwb3NpdGlvbi5pbnRlcnBvbGF0ZSh7XG4gICAgICAgICAgaW5wdXRSYW5nZTogW2ZpcnN0LCBpbmRleCwgbGFzdF0sXG4gICAgICAgICAgb3V0cHV0UmFuZ2U6IEkxOG5NYW5hZ2VyLmlzUlRMID8gb3V0cHV0UmFuZ2UucmV2ZXJzZSgpIDogb3V0cHV0UmFuZ2UsXG4gICAgICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgICAgIH0pLFxuICAgICAgfSxcbiAgICBdLFxuICB9O1xufVxuXG4vLyBEZWZhdWx0IHRvIGZhZGUgdHJhbnNpdGlvblxuY29uc3QgZm9yQmFja2dyb3VuZCA9IGZvckJhY2tncm91bmRXaXRoSW5hY3RpdmVIaWRkZW47XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgZm9yTGF5b3V0LFxuICBmb3JMZWZ0LFxuICBmb3JMZWZ0QnV0dG9uLFxuICBmb3JMZWZ0TGFiZWwsXG4gIGZvckNlbnRlckZyb21MZWZ0LFxuICBmb3JDZW50ZXIsXG4gIGZvclJpZ2h0LFxuICBmb3JCYWNrZ3JvdW5kLFxuICBmb3JCYWNrZ3JvdW5kV2l0aEluYWN0aXZlSGlkZGVuLFxuICBmb3JCYWNrZ3JvdW5kV2l0aEZhZGUsXG4gIGZvckJhY2tncm91bmRXaXRoVHJhbnNsYXRpb24sXG59O1xuIl19