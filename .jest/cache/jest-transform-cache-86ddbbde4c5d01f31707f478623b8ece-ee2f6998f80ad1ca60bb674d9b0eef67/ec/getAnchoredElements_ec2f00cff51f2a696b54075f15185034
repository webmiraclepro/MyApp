9420b0d0cd01e598e0debd80d5e7de65
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getAnchoredElements = void 0;

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread"));

var _react = _interopRequireDefault(require("react"));

var _reactNative = require("react-native");

var _TransitionItem = _interopRequireDefault(require("../TransitionItem"));

var _Utils = require("../Utils");

var getAnchoredElements = function getAnchoredElements(sharedElements, getInterpolationFunction) {
  var retVal = [];
  sharedElements.forEach(function (p) {
    if (p.toItem.anchors && p.toItem.anchors.length > 0) {
      p.toItem.anchors.forEach(function (a) {
        var scale = p.fromItem.scaleRelativeTo(p.toItem);
        var scaleOp = p.toItem.scaleRelativeTo(p.fromItem);
        retVal.push(createAnchoredView(a, p.toItem, p.fromItem, getInterpolationFunction, scale, scaleOp));
      });
    }
  });
  return retVal;
};

exports.getAnchoredElements = getAnchoredElements;

var createAnchoredView = function createAnchoredView(anchor, to, from, getInterpolationFunction, scale, scaleOp) {
  var interpolator = getInterpolationFunction(true);
  var scaleX = interpolator.interpolate({
    inputRange: [0, 1],
    outputRange: [scale.x, 1]
  });
  var scaleY = interpolator.interpolate({
    inputRange: [0, 1],
    outputRange: [scale.y, 1]
  });
  var main0center = {
    x: from.metrics.x + from.metrics.width / 2,
    y: from.metrics.y + from.metrics.height / 2
  };
  var main1center = {
    x: to.metrics.x + to.metrics.width / 2,
    y: to.metrics.y + to.metrics.height / 2
  };
  var element1center = {
    x: anchor.metrics.x + anchor.metrics.width / 2,
    y: anchor.metrics.y + anchor.metrics.height / 2
  };
  var element1offset = {
    x: element1center.x - main1center.x,
    y: element1center.y - main1center.y
  };
  var element0offset = {
    x: element1offset.x * scale.x,
    y: element1offset.y * scale.y
  };
  var element0center = {
    x: main0center.x + element0offset.x,
    y: main0center.y + element0offset.y
  };
  var elementmove = {
    x: element0center.x - element1center.x,
    y: element0center.y - element1center.y
  };
  var translateX = interpolator.interpolate({
    inputRange: [0, 1],
    outputRange: [elementmove.x, 0]
  });
  var translateY = interpolator.interpolate({
    inputRange: [0, 1],
    outputRange: [elementmove.y, 0]
  });
  var transformStyle = {
    transform: [{
      translateX: translateX
    }, {
      translateY: translateY
    }, {
      scaleX: scaleX
    }, {
      scaleY: scaleY
    }]
  };
  var fadeStyle = {
    opacity: interpolator.interpolate({
      inputRange: [0, 0.15, 1],
      outputRange: [0, 1, 1]
    })
  };
  var positionStyle = {
    position: 'absolute',
    left: anchor.metrics.x,
    top: anchor.metrics.y,
    width: anchor.metrics.width,
    height: anchor.metrics.height
  };
  var nativeStyles = [transformStyle, positionStyle, fadeStyle];

  var element = _react.default.Children.only(anchor.reactElement.props.children);

  var key = "an-" + anchor.name + anchor.route;
  var props = (0, _objectSpread2.default)({}, element.props, {
    __index: to.index
  });

  var component = _react.default.createElement(element.type, (0, _objectSpread2.default)({}, props, {
    key: key
  }));

  var retVal = (0, _Utils.createAnimatedWrapper)({
    component: component,
    nativeStyles: nativeStyles
  });
  return retVal;
};

var ptToString = function ptToString(p) {
  return "x: " + p.x + " y: " + p.y;
};

var styles = _reactNative.StyleSheet.create({
  anchorElement: {
    position: 'absolute',
    margin: 0,
    marginVertical: 0,
    marginHorizontal: 0,
    marginTop: 0,
    marginBottom: 0,
    marginLeft: 0,
    marginRight: 0,
    marginStart: 0,
    marginEnd: 0
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldEFuY2hvcmVkRWxlbWVudHMuanMiXSwibmFtZXMiOlsiZ2V0QW5jaG9yZWRFbGVtZW50cyIsInNoYXJlZEVsZW1lbnRzIiwiZ2V0SW50ZXJwb2xhdGlvbkZ1bmN0aW9uIiwicmV0VmFsIiwiZm9yRWFjaCIsInAiLCJ0b0l0ZW0iLCJhbmNob3JzIiwibGVuZ3RoIiwiYSIsInNjYWxlIiwiZnJvbUl0ZW0iLCJzY2FsZVJlbGF0aXZlVG8iLCJzY2FsZU9wIiwicHVzaCIsImNyZWF0ZUFuY2hvcmVkVmlldyIsImFuY2hvciIsInRvIiwiZnJvbSIsImludGVycG9sYXRvciIsInNjYWxlWCIsImludGVycG9sYXRlIiwiaW5wdXRSYW5nZSIsIm91dHB1dFJhbmdlIiwieCIsInNjYWxlWSIsInkiLCJtYWluMGNlbnRlciIsIm1ldHJpY3MiLCJ3aWR0aCIsImhlaWdodCIsIm1haW4xY2VudGVyIiwiZWxlbWVudDFjZW50ZXIiLCJlbGVtZW50MW9mZnNldCIsImVsZW1lbnQwb2Zmc2V0IiwiZWxlbWVudDBjZW50ZXIiLCJlbGVtZW50bW92ZSIsInRyYW5zbGF0ZVgiLCJ0cmFuc2xhdGVZIiwidHJhbnNmb3JtU3R5bGUiLCJ0cmFuc2Zvcm0iLCJmYWRlU3R5bGUiLCJvcGFjaXR5IiwicG9zaXRpb25TdHlsZSIsInBvc2l0aW9uIiwibGVmdCIsInRvcCIsIm5hdGl2ZVN0eWxlcyIsImVsZW1lbnQiLCJSZWFjdCIsIkNoaWxkcmVuIiwib25seSIsInJlYWN0RWxlbWVudCIsInByb3BzIiwiY2hpbGRyZW4iLCJrZXkiLCJuYW1lIiwicm91dGUiLCJfX2luZGV4IiwiaW5kZXgiLCJjb21wb25lbnQiLCJjcmVhdGVFbGVtZW50IiwidHlwZSIsInB0VG9TdHJpbmciLCJzdHlsZXMiLCJTdHlsZVNoZWV0IiwiY3JlYXRlIiwiYW5jaG9yRWxlbWVudCIsIm1hcmdpbiIsIm1hcmdpblZlcnRpY2FsIiwibWFyZ2luSG9yaXpvbnRhbCIsIm1hcmdpblRvcCIsIm1hcmdpbkJvdHRv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QyxJQUFBQSxXQUFXLEVBQUUsQ0FWQTtBQVdiQyxJQUFBQSxXQUFXLEVBQUUsQ0FYQTtBQVliQyxJQUFBQSxTQUFTLEVBQUU7QUFaRTtBQURnQixDQUFsQixDQUFmIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFN0eWxlU2hlZXQgfSBmcm9tICdyZWFjdC1uYXRpdmUnO1xuXG5pbXBvcnQgVHJhbnNpdGlvbkl0ZW0gZnJvbSAnLi4vVHJhbnNpdGlvbkl0ZW0nO1xuaW1wb3J0IHsgY3JlYXRlQW5pbWF0ZWRXcmFwcGVyIH0gZnJvbSAnLi4vVXRpbHMnO1xuXG5jb25zdCBnZXRBbmNob3JlZEVsZW1lbnRzID0gKHNoYXJlZEVsZW1lbnRzOiBBcnJheTxhbnk+LCBnZXRJbnRlcnBvbGF0aW9uRnVuY3Rpb246IEZ1bmN0aW9uKSA9PiB7XG4gIGNvbnN0IHJldFZhbCA9IFtdO1xuICBzaGFyZWRFbGVtZW50cy5mb3JFYWNoKHAgPT4ge1xuICAgIGlmIChwLnRvSXRlbS5hbmNob3JzICYmIHAudG9JdGVtLmFuY2hvcnMubGVuZ3RoID4gMCkge1xuICAgICAgcC50b0l0ZW0uYW5jaG9ycy5mb3JFYWNoKGEgPT4ge1xuICAgICAgICBjb25zdCBzY2FsZSA9IHAuZnJvbUl0ZW0uc2NhbGVSZWxhdGl2ZVRvKHAudG9JdGVtKTtcbiAgICAgICAgY29uc3Qgc2NhbGVPcCA9IHAudG9JdGVtLnNjYWxlUmVsYXRpdmVUbyhwLmZyb21JdGVtKTtcblxuICAgICAgICByZXRWYWwucHVzaChjcmVhdGVBbmNob3JlZFZpZXcoYSwgcC50b0l0ZW0sIHAuZnJvbUl0ZW0sXG4gICAgICAgICAgZ2V0SW50ZXJwb2xhdGlvbkZ1bmN0aW9uLCBzY2FsZSwgc2NhbGVPcCkpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHJldFZhbDtcbn07XG5cbmNvbnN0IGNyZWF0ZUFuY2hvcmVkVmlldyA9IChhbmNob3I6IFRyYW5zaXRpb25JdGVtLCB0bzogVHJhbnNpdGlvbkl0ZW0sXG4gIGZyb206IFRyYW5zaXRpb25JdGVtLCBnZXRJbnRlcnBvbGF0aW9uRnVuY3Rpb246IEZ1bmN0aW9uLCBzY2FsZTogYW55LCBzY2FsZU9wOiBhbnkpID0+IHtcbiAgY29uc3QgaW50ZXJwb2xhdG9yID0gZ2V0SW50ZXJwb2xhdGlvbkZ1bmN0aW9uKHRydWUpO1xuXG4gIGNvbnN0IHNjYWxlWCA9IGludGVycG9sYXRvci5pbnRlcnBvbGF0ZSh7XG4gICAgaW5wdXRSYW5nZTogWzAsIDFdLFxuICAgIG91dHB1dFJhbmdlOiBbc2NhbGUueCwgMV0sXG4gIH0pO1xuXG4gIGNvbnN0IHNjYWxlWSA9IGludGVycG9sYXRvci5pbnRlcnBvbGF0ZSh7XG4gICAgaW5wdXRSYW5nZTogWzAsIDFdLFxuICAgIG91dHB1dFJhbmdlOiBbc2NhbGUueSwgMV0sXG4gIH0pO1xuXG4gIGNvbnN0IG1haW4wY2VudGVyID0geyB4OiBmcm9tLm1ldHJpY3MueCArIGZyb20ubWV0cmljcy53aWR0aCAvIDIsXG4gICAgeTogZnJvbS5tZXRyaWNzLnkgKyBmcm9tLm1ldHJpY3MuaGVpZ2h0IC8gMiB9O1xuXG4gIGNvbnN0IG1haW4xY2VudGVyID0geyB4OiB0by5tZXRyaWNzLnggKyB0by5tZXRyaWNzLndpZHRoIC8gMixcbiAgICB5OiB0by5tZXRyaWNzLnkgKyB0by5tZXRyaWNzLmhlaWdodCAvIDIgfTtcblxuICBjb25zdCBlbGVtZW50MWNlbnRlciA9IHsgeDogYW5jaG9yLm1ldHJpY3MueCArIGFuY2hvci5tZXRyaWNzLndpZHRoIC8gMixcbiAgICB5OiBhbmNob3IubWV0cmljcy55ICsgYW5jaG9yLm1ldHJpY3MuaGVpZ2h0IC8gMiB9O1xuXG4gIGNvbnN0IGVsZW1lbnQxb2Zmc2V0ID0geyB4OiBlbGVtZW50MWNlbnRlci54IC0gbWFpbjFjZW50ZXIueCxcbiAgICB5OiBlbGVtZW50MWNlbnRlci55IC0gbWFpbjFjZW50ZXIueSB9O1xuXG4gIGNvbnN0IGVsZW1lbnQwb2Zmc2V0ID0geyB4OiBlbGVtZW50MW9mZnNldC54ICogc2NhbGUueCxcbiAgICB5OiBlbGVtZW50MW9mZnNldC55ICogc2NhbGUueSB9O1xuXG4gIGNvbnN0IGVsZW1lbnQwY2VudGVyID0geyB4OiBtYWluMGNlbnRlci54ICsgZWxlbWVudDBvZmZzZXQueCxcbiAgICB5OiBtYWluMGNlbnRlci55ICsgZWxlbWVudDBvZmZzZXQueSB9O1xuXG4gIGNvbnN0IGVsZW1lbnRtb3ZlID0geyB4OiBlbGVtZW50MGNlbnRlci54IC0gZWxlbWVudDFjZW50ZXIueCxcbiAgICB5OiBlbGVtZW50MGNlbnRlci55IC0gZWxlbWVudDFjZW50ZXIueSB9O1xuXG4gIGNvbnN0IHRyYW5zbGF0ZVggPSBpbnRlcnBvbGF0b3IuaW50ZXJwb2xhdGUoe1xuICAgIGlucHV0UmFuZ2U6IFswLCAxXSxcbiAgICBvdXRwdXRSYW5nZTogW2VsZW1lbnRtb3ZlLngsIDBdLFxuICB9KTtcblxuICBjb25zdCB0cmFuc2xhdGVZID0gaW50ZXJwb2xhdG9yLmludGVycG9sYXRlKHtcbiAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgb3V0cHV0UmFuZ2U6IFtlbGVtZW50bW92ZS55LCAwXSxcbiAgfSk7XG5cbiAgY29uc3QgdHJhbnNmb3JtU3R5bGUgPSB7IHRyYW5zZm9ybTpcbiAgICBbeyB0cmFuc2xhdGVYIH0sIHsgdHJhbnNsYXRlWSB9LCB7IHNjYWxlWCB9LCB7IHNjYWxlWSB9XSxcbiAgfTtcblxuICBjb25zdCBmYWRlU3R5bGUgPSB7IG9wYWNpdHk6IGludGVycG9sYXRvci5pbnRlcnBvbGF0ZSh7XG4gICAgaW5wdXRSYW5nZTogWzAsIDAuMTUsIDFdLFxuICAgIG91dHB1dFJhbmdlOiBbMCwgMSwgMV0sXG4gIH0pIH07XG5cbiAgY29uc3QgcG9zaXRpb25TdHlsZSA9IHtcbiAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICBsZWZ0OiBhbmNob3IubWV0cmljcy54LFxuICAgIHRvcDogYW5jaG9yLm1ldHJpY3MueSxcbiAgICB3aWR0aDogYW5jaG9yLm1ldHJpY3Mud2lkdGgsXG4gICAgaGVpZ2h0OiBhbmNob3IubWV0cmljcy5oZWlnaHQsXG4gIH07XG5cbiAgY29uc3QgbmF0aXZlU3R5bGVzID0gW3RyYW5zZm9ybVN0eWxlLCBwb3NpdGlvblN0eWxlLCBmYWRlU3R5bGVdO1xuXG4gIGNvbnN0IGVsZW1lbnQgPSBSZWFjdC5DaGlsZHJlbi5vbmx5KGFuY2hvci5yZWFjdEVsZW1lbnQucHJvcHMuY2hpbGRyZW4pO1xuICBjb25zdCBrZXkgPSBgYW4tJHthbmNob3IubmFtZX0ke2FuY2hvci5yb3V0ZX1gO1xuICBjb25zdCBwcm9wcyA9IHsgLi4uZWxlbWVudC5wcm9wcywgX19pbmRleDogdG8uaW5kZXggfTtcbiAgY29uc3QgY29tcG9uZW50ID0gUmVhY3QuY3JlYXRlRWxlbWVudChlbGVtZW50LnR5cGUsIHsgLi4ucHJvcHMsIGtleSB9KTtcbiAgY29uc3QgcmV0VmFsID0gY3JlYXRlQW5pbWF0ZWRXcmFwcGVyKHsgY29tcG9uZW50LCBuYXRpdmVTdHlsZXMgfSk7XG4gIHJldHVybiByZXRWYWw7XG59O1xuXG5jb25zdCBwdFRvU3RyaW5nID0gKHApID0+IGB4OiAke3AueH0geTogJHtwLnl9YDtcblxuY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoe1xuICBhbmNob3JFbGVtZW50OiB7XG4gICAgLy8gYm9yZGVyQ29sb3I6ICcjMDBGJyxcbiAgICAvLyBib3JkZXJXaWR0aDogMSxcbiAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICBtYXJnaW46IDAsXG4gICAgbWFyZ2luVmVydGljYWw6IDAsXG4gICAgbWFyZ2luSG9yaXpvbnRhbDogMCxcbiAgICBtYXJnaW5Ub3A6IDAsXG4gICAgbWFyZ2luQm90dG9tOiAwLFxuICAgIG1hcmdpbkxlZnQ6IDAsXG4gICAgbWFyZ2luUmlnaHQ6IDAsXG4gICAgbWFyZ2luU3RhcnQ6IDAsXG4gICAgbWFyZ2luRW5kOiAwLFxuICB9LFxufSk7XG5cbmV4cG9ydCB7IGdldEFuY2hvcmVkRWxlbWVudHMgfTtcbiJdfQ==