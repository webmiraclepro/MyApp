{"version":3,"sources":["getAnchoredElements.js"],"names":["getAnchoredElements","sharedElements","getInterpolationFunction","retVal","forEach","p","toItem","anchors","length","a","scale","fromItem","scaleRelativeTo","scaleOp","push","createAnchoredView","anchor","to","from","interpolator","scaleX","interpolate","inputRange","outputRange","x","scaleY","y","main0center","metrics","width","height","main1center","element1center","element1offset","element0offset","element0center","elementmove","translateX","translateY","transformStyle","transform","fadeStyle","opacity","positionStyle","position","left","top","nativeStyles","element","React","Children","only","reactElement","props","children","key","name","route","__index","index","component","createElement","type","ptToString","styles","StyleSheet","create","anchorElement","margin","marginVertical","marginHorizontal","marginTop","marginBottom","marginLeft","marginRight","marginStart","marginEnd"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { StyleSheet } from 'react-native';\n\nimport TransitionItem from '../TransitionItem';\nimport { createAnimatedWrapper } from '../Utils';\n\nconst getAnchoredElements = (sharedElements: Array<any>, getInterpolationFunction: Function) => {\n  const retVal = [];\n  sharedElements.forEach(p => {\n    if (p.toItem.anchors && p.toItem.anchors.length > 0) {\n      p.toItem.anchors.forEach(a => {\n        const scale = p.fromItem.scaleRelativeTo(p.toItem);\n        const scaleOp = p.toItem.scaleRelativeTo(p.fromItem);\n\n        retVal.push(createAnchoredView(a, p.toItem, p.fromItem,\n          getInterpolationFunction, scale, scaleOp));\n      });\n    }\n  });\n  return retVal;\n};\n\nconst createAnchoredView = (anchor: TransitionItem, to: TransitionItem,\n  from: TransitionItem, getInterpolationFunction: Function, scale: any, scaleOp: any) => {\n  const interpolator = getInterpolationFunction(true);\n\n  const scaleX = interpolator.interpolate({\n    inputRange: [0, 1],\n    outputRange: [scale.x, 1],\n  });\n\n  const scaleY = interpolator.interpolate({\n    inputRange: [0, 1],\n    outputRange: [scale.y, 1],\n  });\n\n  const main0center = { x: from.metrics.x + from.metrics.width / 2,\n    y: from.metrics.y + from.metrics.height / 2 };\n\n  const main1center = { x: to.metrics.x + to.metrics.width / 2,\n    y: to.metrics.y + to.metrics.height / 2 };\n\n  const element1center = { x: anchor.metrics.x + anchor.metrics.width / 2,\n    y: anchor.metrics.y + anchor.metrics.height / 2 };\n\n  const element1offset = { x: element1center.x - main1center.x,\n    y: element1center.y - main1center.y };\n\n  const element0offset = { x: element1offset.x * scale.x,\n    y: element1offset.y * scale.y };\n\n  const element0center = { x: main0center.x + element0offset.x,\n    y: main0center.y + element0offset.y };\n\n  const elementmove = { x: element0center.x - element1center.x,\n    y: element0center.y - element1center.y };\n\n  const translateX = interpolator.interpolate({\n    inputRange: [0, 1],\n    outputRange: [elementmove.x, 0],\n  });\n\n  const translateY = interpolator.interpolate({\n    inputRange: [0, 1],\n    outputRange: [elementmove.y, 0],\n  });\n\n  const transformStyle = { transform:\n    [{ translateX }, { translateY }, { scaleX }, { scaleY }],\n  };\n\n  const fadeStyle = { opacity: interpolator.interpolate({\n    inputRange: [0, 0.15, 1],\n    outputRange: [0, 1, 1],\n  }) };\n\n  const positionStyle = {\n    position: 'absolute',\n    left: anchor.metrics.x,\n    top: anchor.metrics.y,\n    width: anchor.metrics.width,\n    height: anchor.metrics.height,\n  };\n\n  const nativeStyles = [transformStyle, positionStyle, fadeStyle];\n\n  const element = React.Children.only(anchor.reactElement.props.children);\n  const key = `an-${anchor.name}${anchor.route}`;\n  const props = { ...element.props, __index: to.index };\n  const component = React.createElement(element.type, { ...props, key });\n  const retVal = createAnimatedWrapper({ component, nativeStyles });\n  return retVal;\n};\n\nconst ptToString = (p) => `x: ${p.x} y: ${p.y}`;\n\nconst styles = StyleSheet.create({\n  anchorElement: {\n    // borderColor: '#00F',\n    // borderWidth: 1,\n    position: 'absolute',\n    margin: 0,\n    marginVertical: 0,\n    marginHorizontal: 0,\n    marginTop: 0,\n    marginBottom: 0,\n    marginLeft: 0,\n    marginRight: 0,\n    marginStart: 0,\n    marginEnd: 0,\n  },\n});\n\nexport { getAnchoredElements };\n"]}